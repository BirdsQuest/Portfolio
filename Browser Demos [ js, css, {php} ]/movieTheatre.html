<!DOCTYPE html><html latestURL="https://randomcode.run/movieTheatre" version="1.0" lang="en"><title>Movie Theatre</title><meta charset="utf-8"><link rel="icon" type="image/x-icon" href="images/favicon.ico"><script src="images/movieTheatre/qrious.min.js"></script><script>const version="1.00",baseURL="randomcode.run",contactMail="mattbird@randomcode.run";function HEADER(name){console.log.apply(console,["\n%c\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\u00A0%c MADE WITH:"+("                                   v"+version).slice((version+"".length))+" %c\u00A0\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\n"+"%c\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\u00A0%c\u00A0\u2590\u2588\u2580\u2584\u00A0\u2584\u2580\u2580\u2584\u00A0\u2588\u2584\u00A0\u00A0\u2588\u2590\u2588\u2580\u2588\u00A0\u2584\u2580\u2580\u2584\u00A0\u2588\u2584\u00A0\u2584\u2588\u00A0\u2584\u2580\u2580\u2584\u00A0\u2584\u2580\u2580\u2584\u2590\u2588\u2580\u2588\u00A0\u2588\u2580\u2580\u00A0\u00A0%c\u00A0\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\n%c\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\u00A0%c\u00A0\u2590\u2588\u2584\u2580\u00A0\u2588\u2584\u2584\u2588\u00A0\u2588\u00A0\u2588\u00A0\u2588\u2590\u2588\u00A0\u2590\u258C\u2588\u00A0\u00A0\u2588\u00A0\u2588\u00A0\u2588\u00A0\u2588\u00A0\u2588\u00A0\u00A0\u00A0\u00A0\u2588\u00A0\u00A0\u2588\u2590\u2588\u00A0\u2590\u258C\u2588\u2580\u00A0\u00A0\u00A0%c\u00A0\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\n%c\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\u00A0%c\u00A0\u2590\u2588\u00A0\u2588\u00A0\u2588\u00A0\u00A0\u2588\u00A0\u2588\u00A0\u00A0\u2580\u2588\u2590\u2588\u2584\u2588\u00A0\u2580\u2584\u2584\u2580\u00A0\u2588\u00A0\u00A0\u00A0\u2588\u00A0\u2580\u2584\u2584\u2580\u00A0\u2580\u2584\u2584\u2580\u2590\u2588\u2584\u2588\u00A0\u2588\u2584\u2584\u00A0\u00A0%c\u00A0\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\n%c\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\u00A0%c https://"+baseURL+"/ | "+contactMail+" %c\u00A0\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\n%c\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\u00A0%c run(\""+name+"\");                                  ".slice(-10-name+"".length)+"%c\u00A0\u00A0\u00A0%c\u00A0\u00A0%c\u00A0\u00A0\n",...['background:#00e600','background:#009900','background:#006600','color:#ffffff;background:#003300','background: #006600','background: #009900','background: #00e600'],...['background:#00e600','background:#009900','background:#006600','color:#ffffff;background:#003300','background: #006600','background: #009900','background: #00e600'],...['background:#00e600','background:#009900','background:#006600','color:#ffffff;background:#003300','background: #006600','background: #009900','background: #00e600'],...['background:#00e600','background:#009900','background:#006600','color:#ffffff;background:#003300','background: #006600','background: #009900','background: #00e600'],...['background:#00e600','background:#009900','background:#006600','color:#ffffff;background:#003300','background: #006600','background: #009900','background: #00e600'],...['background:#00e600','background:#009900','background:#006600','color:#ffffff;background:#003300','background: #006600','background: #009900','background: #00e600']])};/*
randomcodode.run/
░░▒▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒░░
░░▒▒▓▓▓													 ▓▓▓▒▒░░
░░▒▒▓▓▓ ▐█▀▄ ▄▀▀▄ █▄  █▐█▀█ ▄▀▀▄ █▄ ▄█ ▄▀▀▄ ▄▀▀▄▐█▀█ █▀▀ ▓▓▓▒▒░░
░░▒▒▓▓▓ ▐█▄▀ █▄▄█ █ █ █▐█ ▐▌█  █ █ █ █ █    █  █▐█ ▐▌█▀  ▓▓▓▒▒░░
░░▒▒▓▓▓ ▐█ █ █  █ █  ▀█▐█▄█ ▀▄▄▀ █   █ ▀▄▄▀ ▀▄▄▀▐█▄█ █▄▄ ▓▓▓▒▒░░
░░▒▒▓▓▓ https://randomcode.run | mattbird@randomcode.run ▓▓▓▒▒░░
░░▒▒▓▓▓             	 movieTheatre v1.0	 	   		     ▓▓▓▒▒░░
░░▒▒▓▓▓													 ▓▓▓▒▒░░
░░▒▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒░░
░░▒▒▓▓▓													 ▓▓▓▒▒░░
░░▒▒▓▓▓													 ▓▓▓▒▒░░
░░▒▒▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▒▒░░*/</script>
<script>
let mov = 0;
window.onload = (e) => {
  var url = window.location.pathname,
    filename = url.substring(url.lastIndexOf("/") + 1);
  filename = filename.substring(0, filename.lastIndexOf("."));
  HEADER(filename);
  document.body.appendChild(new MovieTheatre().DOM);
};
var lang = 0;
var text = [
  {
    currency: "$",
    colon: ":",
    period: ".",
    back: "< BACK",
    next: "NEXT >",
    movieSelector: "Select Your Movie",
    jp: "JP",
    en: "EN",
    subs: " SUB",
    sessionSelector: "Select Your Session Time",
    ticketSelector: "Select your tickets",
    minutes: "mins",
    dateFormat: "en-NZ",
    adult: "ADULT",
    senior: "SENIOR",
    student: "STUDENT",
    child: "CHILD",
    total: "Total",
    seatSelector: "Where would you like to sit?",
    preorderSnackScreen: "Would you like to preorder any snacks for 10% off?",
    popcorn: "Popcorn",
    drink: "Drink",
    churro: "Churro",
    chocolate: "Chocolate",
    iceCream: "Ice Cream Cone",
    kidsCombo: "Kids Combo",
    combo: "Combo",
    superCombo: "Super Combo",
    jumboCombo: "Jumbo Combo",
    epicCombo: "Epic Combo",
    specialEditionCombo: "Special Edition Combo",
    small: "Small",
    medium: "Medium",
    large: "Large",
    salt: "Salt",
    butter: "Butter",
    caramel: "Caramel",
    coke: "Coke",
    melonFanta: "Melon Fanta",
    sprite: "Sprite",
    lp: "L&P",
    rootBeer: "Root Beer",
    orangeJuice: "Orange Juice",
    plain: "Plain",
    snickers: "Snickers",
    mars: "Mars",
    milkyWay: "Milky Way",
    mMs: "M&M's",
    maltesers: "Maltesers",
    mikeIkes: "Mike & Ikes",
    dip: "Dip",
    nutDip: "Nut Dip",
    miniDessert: "Mini Dessert",
    dessert: "Dessert",
    specialGift: "Special Gift",
    cart: "Cart",
    confirmScreen: "Please confirm the selection",
    movie: "Movie",
    when: "When",
    language: "Language",
    subtitles: "Subtitles",
    seats: "Seats",
    preorderedSnacks: "Preordered Snacks",
    paymentScreen: "Select your payment option",
    payAtCounter: "Pay at Counter",
    creditCard: "Credit Card",
    payPal: "PayPal",
    linePay: "LINEPay",
    familyMartPay: "FamilyMart Pay",
    sevenElevenPay: "7/11 Pay",
    payAtCounterText:
      "Be sure to present your ticket at the counter in the theatre to pay.",
    name: "Name",
    cardNumber: "Card Number",
    expiration: "Expiration [MM/YY]",
    security: "Security Code",
    paypalLogin: "Please login to pay via PayPal",
    lineLogin: "Please login to pay via Line",
    familyMartPayPage:
      "Pay at Family Mart before going to the Theatre.\nFollow the instructions on the ticket page.",
    sevenElevenPayPage:
      "Pay at 7/11 before going to the Theatre.\nFollow the instructions on the ticket page.",
    username: "Username",
    password: "Password",
    submit: "Submit",
    ticketScreen: "Here's your ticket, have fun!",
    until: " until ",
    finished: "",
    cinema: "Cinema",
    cost: "Cost",
    cinemaName: "randomCINEMA",
    ticketWarning:
      "You should print or email a copy of your ticket so you don't lose it.\nAfter you leave the page it is no longer stored on our server.",
    printTicket: "Print Ticket",
    emailAddress: "Email Address",
    emailTicket: "Email Ticket",
    payAtCounterBefore:
      "Don't forget to pay at the front counter before going to your seat.",
    successfullyPaid:
      "You have successfully paid, when you get to the cinema feel free to collect any snacks and go to your seat.",
    payAtSevenEleven:
      "Before going to the theatre, please pay for your ticket at 7/11.",
    payAtFamiMa:
      "Before going to the theatre, please pay for your ticket at Family Mart.",
    paymentInstruction: "Follow the link for mores information on how to pay.",
    paymentGuide: "Payment Guide",
    googleTranslate:
      "https://translate.google.com/translate?js=n&sl=jp-JP&tl=en&u=",
  },
  {
    currency: "¥",
    colon: ":",
    period: "。",
    back: "＜ 前",
    next: "次 ＞",
    movieSelector: "映画を選んでください",
    jp: "日本語",
    en: "英語",
    subs: "字幕",
    sessionSelector: "セッションの時間を選んでください",
    ticketSelector: "チケットを選んでください",
    minutes: "分",
    dateFormat: "ja-JP",
    adult: "大人",
    senior: "高齢者",
    student: "学生",
    child: "子供",
    total: "合計",
    seatSelector: "どこに座りたいですか？",
    preorderSnackScreen: "スナックを10％オフで事前注文しますか？",
    popcorn: "ポップアップ",
    drink: "飲み物",
    churro: "チュロス",
    chocolate: "チョコ",
    iceCream: "アイス",
    kidsCombo: "子供コンボ",
    combo: "コンボ",
    superCombo: "スパーコッンボ",
    jumboCombo: "ジャンボコンボ",
    epicCombo: "デラックスコンボ",
    specialEditionCombo: "限定コンボ",
    small: "小",
    medium: "中",
    large: "大",
    salt: "塩",
    butter: "バター",
    caramel: "カラメル",
    coke: "コーク",
    melonFanta: "メロンファンタ",
    sprite: "スプライト",
    lp: "L&P",
    rootBeer: "ルートビア",
    orangeJuice: "オレンジジュース",
    plain: "普通",
    snickers: "スニッカーズ",
    mars: "マース",
    milkyWay: "ミルキーウェイ",
    mMs: "M&M's",
    maltesers: "モルティーザーズ",
    mikeIkes: "マイク＆アイク",
    dip: "ディップ",
    nutDip: "ナッツディップ",
    miniDessert: "ミニデザート",
    dessert: "デザート",
    specialGift: "特別なギフト",
    cart: "カート",
    confirmScreen: "詳細を確認してください",
    movie: "映画",
    when: "何時",
    language: "言語",
    subtitles: "字幕",
    seats: "シート",
    preorderedSnacks: "予約注文スナック",
    paymentScreen: "支払いオプションを選んでください",
    payAtCounter: "店頭でお支払い",
    creditCard: "クレジットカード",
    payPal: "ペイパル",
    linePay: "LINE Pay",
    familyMartPay: "ファミペイ",
    sevenElevenPay: "7/11 Pay",
    payAtCounterText:
      "映画館のカウンターでチケットを提示してお支払いください。",
    name: "名前",
    cardNumber: "カード番語",
    expiration: "有効期限 [MM/YY]",
    security: "セキュリティコード",
    paypalLogin: "ログインしてペイパでお支払いください",
    lineLogin: "ログインしてLINEでお支払いください",
    familyMartPayPage:
      "劇場に行く前にファミリーマートで支払います。\nチケットページの指示に従ってください。",
    sevenElevenPayPage:
      "劇場に行く前にセブンイレブンで支払います。\nチケットページの指示に従ってください。",
    username: "ユーザー名",
    password: "パースワード",
    submit: "確認",
    ticketScreen: "はい、チッケトどうぞ。楽しんでください！",
    until: "から",
    finished: "まで",
    cost: "代金",
    cinema: "シネマ",
    cinemaName: "ランダムシネマ",
    ticketWarning:
      "チケットを紛失しないように、チケットのコピーを印刷または電子メールで送信する必要があります。\nページを離れると、サーバーに保存されなくなります。",
    printTicket: "チッケトをプリントして",
    emailAddress: "メールアドレス",
    emailTicket: "チッケトを送って",
    payAtCounterBefore:
      "席に着く前にフロントカウンターで支払うことを忘れないでください。",
    successfullyPaid: "映画館に着いたら、気軽に軽食を集めて席に着きましょう。",
    payAtSevenEleven:
      "劇場に行く前に、セブンイレブンでチケットをお支払いください。",
    payAtFamiMa:
      "劇場に行く前に、ファミリーマートでチケット代金をお支払いください。",
    paymentInstruction:
      "支払い方法の詳細については、リンクをたどってください。",
    paymentGuide: "支払いガイド",
    googleTranslate: "",
  },
];
const MOVIES = [
    //name,relese,runtime
    [
      "The Shawshank Redemption",
      "ショーシャンクの空に",
      "1994-09-23",
      142,
      "Andy Dufresne (Tim Robbins) is sentenced to two consecutive life terms in prison for the murders of his wife and her lover and is sentenced to a tough prison. However, only Andy knows he didn't commit the crimes. While there, he forms a friendship with Red (Morgan Freeman), experiences brutality of prison life, adapts, helps the warden, etc., all in 19 years.",
      "冤罪によってショーシャンク刑務所へ投獄されてしまった有能な銀行員の主人公アンディが、腐敗した刑務所内でも仲間を作り、共に語り合い成長し、理不尽な仕打ちの中でも決して人生を諦めない傑作ヒューマンドラマ。",
    ],
    [
      "The Godfather",
      "ゴッドファーザー",
      "1972-03-24",
      177,
      "Widely regarded as one of the greatest films of all time, this mob drama, based on Mario Puzo's novel of the same name, focuses on the powerful Italian-American crime family of Don Vito Corleone (Marlon Brando). When the don's youngest son, Michael (Al Pacino), reluctantly joins the Mafia, he becomes involved in the inevitable cycle of violence and betrayal. Although Michael tries to maintain a normal relationship with his wife, Kay (Diane Keaton), he is drawn deeper into the family business.",
      "プーゾの同名小説をフランシス・フォード・コッポラ監督が映画化した不朽の名作。1972年公開。公開から40年以上を経た現在でも多くの映画ファンに支持され、映画関係者からの評価も高い。",
    ],
    [
      "The Dark Knight",
      "ダークナイト",
      "2008-07-18",
      152,
      "With the help of allies Lt. Jim Gordon (Gary Oldman) and DA Harvey Dent (Aaron Eckhart), Batman (Christian Bale) has been able to keep a tight lid on crime in Gotham City. But when a vile young criminal calling himself the Joker (Heath Ledger) suddenly throws the town into chaos, the caped Crusader begins to tread a fine line between heroism and vigilantism.",
      "ウェイン産業の会長であるブルースは正体を隠し、「バットマン」として悪党と戦っていた。そんなある日、残忍な犯罪者・ジョーカーが現れる。ジョーカーは正体を明かさなければ人々を殺すと、テレビを通じてバットマンを脅した。",
    ],
    [
      "12 Angry Men",
      "十二人の怒れる男",
      "1957-04-10",
      96,
      "Following the closing arguments in a murder trial, the 12 members of the jury must deliberate, with a guilty verdict meaning death for the accused, an inner-city teen. As the dozen men try to reach a unanimous decision while sequestered in a room, one juror (Henry Fonda) casts considerable doubt on elements of the case. Personal issues soon rise to the surface, and conflict threatens to derail the delicate process that will decide one boy's fate.",
      "父親殺しの罪に問われた少年の裁判で、陪審員が評決に達するまで一室で議論する様子を描く。裁判は被告人である少年に圧倒的に不利で、陪審員8番以外の全員が少年の有罪を確信していた。陪審員8番は証拠や証言の疑わしい点について話し合うことを要求する。",
    ],
    [
      "Schindler's List",
      "シンドラーのリスト",
      "1993-12-15",
      195,
      "Businessman Oskar Schindler (Liam Neeson) arrives in Krakow in 1939, ready to make his fortune from World War II, which has just started. After joining the Nazi party primarily for political expediency, he staffs his factory with Jewish workers for similarly pragmatic reasons. When the SS begins exterminating Jews in the Krakow ghetto, Schindler arranges to have his workers protected to keep his factory in operation, but soon realizes that in so doing, he is also saving innocent lives.",
      "ナチス党員でありながら、自分の工場に必要な人材としてユダヤ人のリストを作り、彼らの命を救ったオスカー・シンドラーの実話を基に製作された作品。ユダヤ系アメリカ人であるスティーヴン・スピルバーグ監督の意欲作で、彼はこの作品により、アカデミー監督賞と作品賞を初受賞した。",
    ],
    [
      "Pulp Fiction",
      "パルプ・フィクション",
      "1994-10-14",
      154,
      "Vincent Vega (John Travolta) and Jules Winnfield (Samuel L. Jackson) are hitmen with a penchant for philosophical discussions. In this ultra-hip, multi-strand crime movie, their storyline is interwoven with those of their boss, gangster Marsellus Wallace (Ving Rhames) ; his actress wife, Mia (Uma Thurman) ; struggling boxer Butch Coolidge (Bruce Willis) ; master fixer Winston Wolfe (Harvey Keitel) and a nervous pair of armed robbers, Pumpkin (Tim Roth) and Honey Bunny (Amanda Plummer).",
      "クエンティン・タランティーノ監督が原案と脚本も務めた群像劇。巧みなストーリー展開とセリフの面白さが評価され、アカデミー賞脚本賞を受賞した。奇想天外な物語の端々に、クエンティン・タランティーノ監督のマニアックな趣味が垣間見えて楽しい。",
    ],
  ],
  TICKETS = []; //session,priceBracket,row,col
const DB = {
  movies: [],
  schedule: [],
};

class MovieTheatre {
  constructor() {
    this.id = Math.floor(Math.random() * 1000000 + 1);
    this.DOM = document.createElement("DIV");
    this.DOM.className = "movieTheatre";
    this.curtains = new Curtains();
    this.DOM.appendChild(this.curtains.DOM);
    this.lang = document.createElement("DIV");
    this.lang.appendChild(document.createElement("IMG"));
    this.lang.appendChild(document.createElement("IMG"));
    ["en", "jp"].forEach((e, i) => {
      this.lang.children[i].src = `images/movieTheatre/language/${e}.png`;
      this.lang.children[i].onclick = (e) => this.setLang(i);
    });
    this.lang.children[lang].className = "selected";
    this.lang.className = "language";
    this.DOM.appendChild(this.lang);
    this.actionText = document.createElement("DIV");
    this.DOM.appendChild(this.actionText);
    this.screen = document.createElement("DIV");
    this.screen.className = "screen";
    this.DOM.appendChild(this.screen);
    this.backBtn = document.createElement("BUTTON");
    this.backBtn.onclick = (e) => this.back();
    this.backBtn.innerText = text[lang].back;
    this.backBtn.className = "navBtn";
    this.DOM.appendChild(this.backBtn);
    this.nextBtn = document.createElement("BUTTON");
    this.nextBtn.onclick = (e) => this.next();
    this.nextBtn.innerText = text[lang].next;
    this.nextBtn.className = "navBtn";
    this.DOM.appendChild(this.nextBtn);

    this.screens = [
      new MovieSelector(this),
      new SessionSelector(this),
      new TicketSelector(this),
      new SeatSelector(this, (e) => this.ticketCount()),
      new PreorderSnacks(this),
      new ConfirmScreen(this),
      new PaymentScreen(this),
      new TicketScreen(this),
    ];
    this.locked = false;
    this.jumpTo(0);
  }
  ticketCount() {
    return this.screens[2].tickets.children.length;
  }
  get movieID() {
    return this.screens[0].selectedMovie;
  }
  get movieName() {
    if (this.movieID == -1) {
      return "";
    }
    return this.screens[0].DOM.children[this.movieID * 2 + 1].children[1]
      .innerText;
  }
  get date() {
    return this.screens[1].selectedDate;
  }
  get time() {
    return this.screens[1].selectedTime;
  }
  get endTime() {
    let date = new Date(),
      time = this.time.split(":");
    date.setHours(time[0]);
    date.setMinutes(time[1]);
    date = new Date(date.getTime() + this.screens[0].runtime * 60000);
    return date.getHours() + ":" + ("0" + date.getMinutes()).slice(-2);
  }
  get language() {
    return this.screens[1].selectedLang;
  }
  get subs() {
    return this.screens[1].selectedSubs;
  }
  get tickets() {
    return [...this.screens[2].tickets.children].map((e) => {
      e = e.children[0];
      return e.options[e.selectedIndex].text;
    });
  }
  get seats() {
    return this.screens[3].seats.map((e) => {
      e = e.split("~");
      return String.fromCharCode(65 + parseInt(e[1])) + e[0];
    });
  }
  get snacks() {
    return this.screens[4].snacks;
  }
  get total() {
    let total = 0;
    total += parseFloat(
      this.screens[2].total.innerText.split(text[lang].currency)[1]
    );
    total += parseFloat(this.screens[4].total.innerText.substring(1)) || 0;
    return text[lang].currency + total;
  }
  get payment() {
    return this.screens[6].selected;
  }
  generateDB() {
    [
      //name,relese,runtime
      [
        "The Shawshank Redemption",
        "ショーシャンクの空に",
        "1994-09-23",
        142,
        "Andy Dufresne (Tim Robbins) is sentenced to two consecutive life terms in prison for the murders of his wife and her lover and is sentenced to a tough prison. However, only Andy knows he didn't commit the crimes. While there, he forms a friendship with Red (Morgan Freeman), experiences brutality of prison life, adapts, helps the warden, etc., all in 19 years.",
        "冤罪によってショーシャンク刑務所へ投獄されてしまった有能な銀行員の主人公アンディが、腐敗した刑務所内でも仲間を作り、共に語り合い成長し、理不尽な仕打ちの中でも決して人生を諦めない傑作ヒューマンドラマ。",
      ],
      [
        "The Godfather",
        "ゴッドファーザー",
        "1972-03-24",
        177,
        "Widely regarded as one of the greatest films of all time, this mob drama, based on Mario Puzo's novel of the same name, focuses on the powerful Italian-American crime family of Don Vito Corleone (Marlon Brando). When the don's youngest son, Michael (Al Pacino), reluctantly joins the Mafia, he becomes involved in the inevitable cycle of violence and betrayal. Although Michael tries to maintain a normal relationship with his wife, Kay (Diane Keaton), he is drawn deeper into the family business.",
        "プーゾの同名小説をフランシス・フォード・コッポラ監督が映画化した不朽の名作。1972年公開。公開から40年以上を経た現在でも多くの映画ファンに支持され、映画関係者からの評価も高い。",
      ],
      [
        "The Dark Knight",
        "ダークナイト",
        "2008-07-18",
        152,
        "With the help of allies Lt. Jim Gordon (Gary Oldman) and DA Harvey Dent (Aaron Eckhart), Batman (Christian Bale) has been able to keep a tight lid on crime in Gotham City. But when a vile young criminal calling himself the Joker (Heath Ledger) suddenly throws the town into chaos, the caped Crusader begins to tread a fine line between heroism and vigilantism.",
        "ウェイン産業の会長であるブルースは正体を隠し、「バットマン」として悪党と戦っていた。そんなある日、残忍な犯罪者・ジョーカーが現れる。ジョーカーは正体を明かさなければ人々を殺すと、テレビを通じてバットマンを脅した。",
      ],
      [
        "12 Angry Men",
        "十二人の怒れる男",
        "1957-04-10",
        96,
        "Following the closing arguments in a murder trial, the 12 members of the jury must deliberate, with a guilty verdict meaning death for the accused, an inner-city teen. As the dozen men try to reach a unanimous decision while sequestered in a room, one juror (Henry Fonda) casts considerable doubt on elements of the case. Personal issues soon rise to the surface, and conflict threatens to derail the delicate process that will decide one boy's fate.",
        "父親殺しの罪に問われた少年の裁判で、陪審員が評決に達するまで一室で議論する様子を描く。裁判は被告人である少年に圧倒的に不利で、陪審員8番以外の全員が少年の有罪を確信していた。陪審員8番は証拠や証言の疑わしい点について話し合うことを要求する。",
      ],
      [
        "Schindler's List",
        "シンドラーのリスト",
        "1993-12-15",
        195,
        "Businessman Oskar Schindler (Liam Neeson) arrives in Krakow in 1939, ready to make his fortune from World War II, which has just started. After joining the Nazi party primarily for political expediency, he staffs his factory with Jewish workers for similarly pragmatic reasons. When the SS begins exterminating Jews in the Krakow ghetto, Schindler arranges to have his workers protected to keep his factory in operation, but soon realizes that in so doing, he is also saving innocent lives.",
        "ナチス党員でありながら、自分の工場に必要な人材としてユダヤ人のリストを作り、彼らの命を救ったオスカー・シンドラーの実話を基に製作された作品。ユダヤ系アメリカ人であるスティーヴン・スピルバーグ監督の意欲作で、彼はこの作品により、アカデミー監督賞と作品賞を初受賞した。",
      ],
      [
        "Pulp Fiction",
        "パルプ・フィクション",
        "1994-10-14",
        154,
        "Vincent Vega (John Travolta) and Jules Winnfield (Samuel L. Jackson) are hitmen with a penchant for philosophical discussions. In this ultra-hip, multi-strand crime movie, their storyline is interwoven with those of their boss, gangster Marsellus Wallace (Ving Rhames) ; his actress wife, Mia (Uma Thurman) ; struggling boxer Butch Coolidge (Bruce Willis) ; master fixer Winston Wolfe (Harvey Keitel) and a nervous pair of armed robbers, Pumpkin (Tim Roth) and Honey Bunny (Amanda Plummer).",
        "クエンティン・タランティーノ監督が原案と脚本も務めた群像劇。巧みなストーリー展開とセリフの面白さが評価され、アカデミー賞脚本賞を受賞した。奇想天外な物語の端々に、クエンティン・タランティーノ監督のマニアックな趣味が垣間見えて楽しい。",
      ],
    ].forEach((e) => DB.movies.push(e));
    let alt = false,
      en = ["en", "jp"],
      jp = ["jp"],
      times = [
        [10, 40],
        [13, 40],
        [16, 40],
        [19, 40],
        [22, 40],
      ];
    [...Array(4).keys()].forEach((week) =>
      [...Array(7).keys()].forEach((dow) =>
        times.forEach((e) =>
          DB.schedule.push([
            offsetDate(week, day, ...e),
            6,
            ...((alt = !alt) ? en : jp),
          ])
        )
      )
    );
  }
  jumpTo(id = 0) {
    this.current = id - 1;
    this.next();
  }
  calculateTicketPrice(ticketType) {
    /*
		Prices Brackets
			Senior
			Adult
			Student
			Under 12
		
		Time Price Mods
			Morning
			Matinee(昼興行)
			Afternoon
			Evening
			Late
		
		Movie Age Mods
			New
			Two Weeks
			One Month
			Two Months
		*/
  }
  back() {
    if (!this.locked && this.current > 0) {
      this.locked = true;
      this.current--;
      this.curtains.close((e) => {
        this.screen.innerText = "";
        this.screen.appendChild(this.screens[this.current].DOM);
        this.actionText.innerText = this.screens[this.current].actionText;
        this.screen.scrollTo(0, 0);
        if (this.current == 0) {
          this.backBtn.disabled = true;
        } else if (this.nextBtn.disabled) {
          this.nextBtn.disabled = false;
        }
        this.locked = false;
      });
    }
  }
  next() {
    if (!this.locked && this.current < this.screens.length - 1) {
      this.locked = true;
      this.current++;
      this.curtains.close((e) => {
        this.screen.innerText = "";
        this.screen.scrollTo(0, 0);
        this.screen.appendChild(this.screens[this.current].DOM);
        this.actionText.innerText = this.screens[this.current].actionText;
        this.screens[this.current].onSelected(this);
        this.locked = false;
      });
    }
  }
  setLang(setLang) {
    if (lang != setLang) {
      this.lang.children[lang].classList.remove("selected");
      this.lang.children[setLang].classList.add("selected");
      lang = setLang;
      this.backBtn.innerText = text[lang].back;
      this.nextBtn.innerText = text[lang].next;
      this.screens.forEach((e) => e.setLang(this));
      console.log(this.screens[this.current].actionText);
      this.actionText.innerText = this.screens[this.current].actionText;
      this.nextBtn.disabled = !this.screens[this.current].canContinue;
    }
  }
}

class Curtains {
  constructor() {
    this.DOM = document.createElement("DIV");
    this.DOM.appendChild(document.createElement("DIV"));
    this.DOM.appendChild(document.createElement("DIV"));
    this.DOM.className = "curtains open";
    this.timeout = null;
  }
  close(action = (e) => e) {
    this.DOM.classList.remove("open");
    setTimeout((e) => {
      action();
      this.reopen();
    }, 300);
  }
  reopen() {
    this.DOM.classList.add("open");
    setTimeout((e) => {}, 300);
  }
}

class Screen {
  constructor(parent, className = n, actionText = "", vars = {}, elems = []) {
    Object.defineProperty(this, "continuable", {
      set: (e) => (parent.nextBtn.disabled = !e),
    });
    this.DOM = document.createElement("DIV");
    this.DOM.className = className;
    this.actionText = actionText;
    for (let key in vars) {
      this[key] = vars[key];
      delete vars[key];
    }
    elems.forEach((e) => this.addElem(e));
  }
  onSelected() {
    this.continuable = this.canContinue;
  }
  get canContinue() {
    return true;
  }
  addElem(e, parent = this.DOM) {
    let propertyName = null;
    if (!Array.isArray(e)) {
      propertyName = Object.keys(e)[0];
      e = e[propertyName];
    }
    let [DOMTYPE, attrs, doms, func] = e,
      elem = document.createElement(DOMTYPE);
    if (propertyName != null) {
      this[propertyName] = elem;
    }
    if (e.length > 2) {
      doms.forEach((e) => this.addElem(e, elem));
    }
    if (e.length > 1 && attrs != null) {
      for (let key in attrs) {
        elem[key] = attrs[key];
      }
    }
    if (e.length > 3) {
      func(elem);
    }
    parent.appendChild(elem);
    return elem;
  }
  formatMoney(amount) {
    return lang == 0
      ? "$" + (Math.round(amount * 100) / 100).toFixed(2)
      : "¥" + Math.round(amount * 100);
  }
  getE(e) {
    e = e || window.event;
    return e.target || e.srcElement;
  }
}

class MovieSelector extends Screen {
  constructor(parent) {
    super(parent, "movieSelector", text[lang].movieSelector);
    this.selectedMovie = -1;
    this.fetchMovies();
  }
  onSelected(parent) {
    super.onSelected();
    parent.backBtn.disabled = true;
  }
  get canContinue() {
    return this.selectedMovie != -1;
  }
  get runtime() {
    return this.selectedMovie == -1
      ? 0
      : this.DOM.children[
          this.selectedMovie * 2 + 1
        ].children[4].innerText.replace(/\D/g, "");
  }
  fetchMovies() {
    this.set(
      [
        [
          "The Shawshank Redemption",
          "ショーシャンクの空に",
          "1994-09-23",
          142,
          "Andy Dufresne (Tim Robbins) is sentenced to two consecutive life terms in prison for the murders of his wife and her lover and is sentenced to a tough prison. However, only Andy knows he didn't commit the crimes. While there, he forms a friendship with Red (Morgan Freeman), experiences brutality of prison life, adapts, helps the warden, etc., all in 19 years.",
          "冤罪によってショーシャンク刑務所へ投獄されてしまった有能な銀行員の主人公アンディが、腐敗した刑務所内でも仲間を作り、共に語り合い成長し、理不尽な仕打ちの中でも決して人生を諦めない傑作ヒューマンドラマ。",
        ],
        [
          "The Godfather",
          "ゴッドファーザー",
          "1972-03-24",
          177,
          "Widely regarded as one of the greatest films of all time, this mob drama, based on Mario Puzo's novel of the same name, focuses on the powerful Italian-American crime family of Don Vito Corleone (Marlon Brando). When the don's youngest son, Michael (Al Pacino), reluctantly joins the Mafia, he becomes involved in the inevitable cycle of violence and betrayal. Although Michael tries to maintain a normal relationship with his wife, Kay (Diane Keaton), he is drawn deeper into the family business.",
          "プーゾの同名小説をフランシス・フォード・コッポラ監督が映画化した不朽の名作。1972年公開。公開から40年以上を経た現在でも多くの映画ファンに支持され、映画関係者からの評価も高い。",
        ],
        [
          "The Dark Knight",
          "ダークナイト",
          "2008-07-18",
          152,
          "With the help of allies Lt. Jim Gordon (Gary Oldman) and DA Harvey Dent (Aaron Eckhart), Batman (Christian Bale) has been able to keep a tight lid on crime in Gotham City. But when a vile young criminal calling himself the Joker (Heath Ledger) suddenly throws the town into chaos, the caped Crusader begins to tread a fine line between heroism and vigilantism.",
          "ウェイン産業の会長であるブルースは正体を隠し、「バットマン」として悪党と戦っていた。そんなある日、残忍な犯罪者・ジョーカーが現れる。ジョーカーは正体を明かさなければ人々を殺すと、テレビを通じてバットマンを脅した。",
        ],
        [
          "12 Angry Men",
          "十二人の怒れる男",
          "1957-04-10",
          96,
          "Following the closing arguments in a murder trial, the 12 members of the jury must deliberate, with a guilty verdict meaning death for the accused, an inner-city teen. As the dozen men try to reach a unanimous decision while sequestered in a room, one juror (Henry Fonda) casts considerable doubt on elements of the case. Personal issues soon rise to the surface, and conflict threatens to derail the delicate process that will decide one boy's fate.",
          "父親殺しの罪に問われた少年の裁判で、陪審員が評決に達するまで一室で議論する様子を描く。裁判は被告人である少年に圧倒的に不利で、陪審員8番以外の全員が少年の有罪を確信していた。陪審員8番は証拠や証言の疑わしい点について話し合うことを要求する。",
        ],
        [
          "Schindler's List",
          "シンドラーのリスト",
          "1993-12-15",
          195,
          "Businessman Oskar Schindler (Liam Neeson) arrives in Krakow in 1939, ready to make his fortune from World War II, which has just started. After joining the Nazi party primarily for political expediency, he staffs his factory with Jewish workers for similarly pragmatic reasons. When the SS begins exterminating Jews in the Krakow ghetto, Schindler arranges to have his workers protected to keep his factory in operation, but soon realizes that in so doing, he is also saving innocent lives.",
          "ナチス党員でありながら、自分の工場に必要な人材としてユダヤ人のリストを作り、彼らの命を救ったオスカー・シンドラーの実話を基に製作された作品。ユダヤ系アメリカ人であるスティーヴン・スピルバーグ監督の意欲作で、彼はこの作品により、アカデミー監督賞と作品賞を初受賞した。",
        ],
        [
          "Pulp Fiction",
          "パルプ・フィクション",
          "1994-10-14",
          154,
          "Vincent Vega (John Travolta) and Jules Winnfield (Samuel L. Jackson) are hitmen with a penchant for philosophical discussions. In this ultra-hip, multi-strand crime movie, their storyline is interwoven with those of their boss, gangster Marsellus Wallace (Ving Rhames) ; his actress wife, Mia (Uma Thurman) ; struggling boxer Butch Coolidge (Bruce Willis) ; master fixer Winston Wolfe (Harvey Keitel) and a nervous pair of armed robbers, Pumpkin (Tim Roth) and Honey Bunny (Amanda Plummer).",
          "クエンティン・タランティーノ監督が原案と脚本も務めた群像劇。巧みなストーリー展開とセリフの面白さが評価され、アカデミー賞脚本賞を受賞した。奇想天外な物語の端々に、クエンティン・タランティーノ監督のマニアックな趣味が垣間見えて楽しい。",
        ],
      ].map((e) => [e[0 + lang], e[4 + lang], e[2], e[3]])
    );
  }
  set(movies) {
    movies.forEach(([name, description, release, runtime], id) => {
      this.addElem([
        "INPUT",
        {
          type: "radio",
          name: "movies",
          value: id,
          id: id,
          onchange: (e) => this.selectMovie(id),
        },
      ]);
      this.addElem([
        "LABEL",
        { className: "movie", htmlFor: id },
        [
          [
            "IMG",
            {
              src: `images/movieTheatre/${lang === 0 ? "en" : "jp"}/${id}.jpg`,
            },
          ],
          ["DIV", { innerText: name }],
          ["DIV", { innerText: description }],
          ["DIV", { innerText: release }],
          ["DIV", { innerText: `${runtime}${text[lang].minutes}` }],
        ],
      ]);
    });
  }
  /*this turned into set, what a difference in code length!
		addMovie(id){
			if(id>MOVIES.length-1){
				return;
			}
			
			let button=document.createElement("INPUT");
			button.type="radio";
			button.name="movies";
			button.value=id;
			button.id=id;
			button.onchange=e=>this.selectMovie(id);
			this.DOM.appendChild(button);
			let movie=document.createElement("LABEL"),
					image=document.createElement("IMG"),
					name=document.createElement("DIV"),
					description=document.createElement("DIV"),
					release=document.createElement("DIV"),
					runtime=document.createElement("DIV");
			movie.className="movie";
			movie.htmlFor=id;
			image.src=`images/en/${id}.jpg`;
			name.innerText=MOVIES[id][0];
			description.innerText=MOVIES[id][4];
			release.innerText=MOVIES[id][2];
			runtime.innerText=MOVIES[id][3];
			movie.appendChild(image);
			movie.appendChild(name);
			movie.appendChild(description);
			movie.appendChild(release);
			movie.appendChild(runtime);
			movie.onclick=e=>this.selectMovie(e);
			this.DOM.appendChild(movie);
		}*/
  selectMovie(e) {
    this.selectedMovie = e;
    this.continuable = true;
  }
  setLang(parent) {
    this.actionText = text[lang].movieSelector;
    this.DOM.innerText = "";
    this.fetchMovies();
    if (this.selectedMovie != -1) {
      this.DOM.children[this.selectedMovie * 2].checked = true;
    }
  }
}

class SessionSelector extends Screen {
  constructor(parent) {
    super(parent, "sessionSelector", text[lang].sessionSelector);
    this.selectedSession = -1;
  }
  onSelected(parent) {
    super.onSelected();
    parent.backBtn.disabled = false;
    this.fetchSessions(parent.movieID);
  }
  get canContinue() {
    return this.selectedSession != -1;
  }
  fetchSessions(movieID) {
    let offsetDate = (week, dayOfWeek, hour, minute) => {
      let slot = new Date();
      slot.setHours(0, 0, 0, 0);
      slot.setDate(
        slot.getDate() - slot.getDay() + week * 7 + (dayOfWeek - slot.getDay())
      );
      slot.setHours(hour);
      slot.setMinutes(minute);
      return slot;
    };
    //ajax("fetchSessions",["movie",movieID],e=>this.set(JSON.stringify(e)));
    this.set([
      //movie,startDateTime,cinema,language,subs
      [offsetDate(0, 0, 13, 40), 6, "en", "jp"],
      [offsetDate(0, 0, 16, 40), 6, "en", "jp"],
      [offsetDate(0, 0, 19, 40), 6, "en", "jp"],
      [offsetDate(0, 0, 22, 40), 6, "en", "jp"],
      [offsetDate(0, 1, 10, 40), 6, "jp"],
      [offsetDate(0, 1, 13, 40), 6, "jp"],
      [offsetDate(0, 1, 16, 40), 6, "jp"],
      [offsetDate(0, 1, 19, 40), 6, "jp"],
      [offsetDate(0, 1, 22, 40), 6, "jp"],
      [offsetDate(0, 2, 10, 40), 6, "en", "jp"],
      [offsetDate(0, 2, 13, 40), 6, "en", "jp"],
      [offsetDate(0, 2, 16, 40), 6, "en", "jp"],
      [offsetDate(0, 2, 19, 40), 6, "en", "jp"],
      [offsetDate(0, 2, 22, 40), 6, "en", "jp"],
      [offsetDate(0, 3, 10, 40), 6, "jp"],
      [offsetDate(0, 3, 13, 40), 6, "jp"],
      [offsetDate(0, 3, 16, 40), 6, "jp"],
      [offsetDate(0, 3, 19, 40), 6, "jp"],
      [offsetDate(0, 3, 22, 40), 6, "jp"],
      [offsetDate(0, 4, 10, 40), 6, "en", "jp"],
      [offsetDate(0, 4, 13, 40), 6, "en", "jp"],
      [offsetDate(0, 4, 16, 40), 6, "en", "jp"],
      [offsetDate(0, 4, 19, 40), 6, "en", "jp"],
      [offsetDate(0, 4, 22, 40), 6, "en", "jp"],
      [offsetDate(0, 5, 10, 40), 6, "jp"],
      [offsetDate(0, 5, 13, 40), 6, "jp"],
      [offsetDate(0, 5, 16, 40), 6, "jp"],
      [offsetDate(0, 5, 19, 40), 6, "jp"],
      [offsetDate(0, 5, 22, 40), 6, "jp"],
      [offsetDate(0, 6, 10, 40), 6, "en", "jp"],
      [offsetDate(0, 6, 13, 40), 6, "en", "jp"],
      [offsetDate(0, 6, 16, 40), 6, "en", "jp"],
      [offsetDate(0, 6, 19, 40), 6, "en", "jp"],
      [offsetDate(0, 6, 22, 40), 6, "en", "jp"],

      [offsetDate(1, 0, 13, 40), 6, "jp"],
      [offsetDate(1, 0, 16, 40), 6, "jp"],
      [offsetDate(1, 0, 19, 40), 6, "jp"],
      [offsetDate(1, 0, 22, 40), 6, "jp"],
      [offsetDate(1, 1, 10, 40), 6, "en", "jp"],
      [offsetDate(1, 1, 13, 40), 6, "en", "jp"],
      [offsetDate(1, 1, 16, 40), 6, "en", "jp"],
      [offsetDate(1, 1, 19, 40), 6, "en", "jp"],
      [offsetDate(1, 1, 22, 40), 6, "en", "jp"],
      [offsetDate(1, 2, 10, 40), 6, "jp"],
      [offsetDate(1, 2, 13, 40), 6, "jp"],
      [offsetDate(1, 2, 16, 40), 6, "jp"],
      [offsetDate(1, 2, 19, 40), 6, "jp"],
      [offsetDate(1, 2, 22, 40), 6, "jp"],
      [offsetDate(1, 3, 10, 40), 6, "en", "jp"],
      [offsetDate(1, 3, 13, 40), 6, "en", "jp"],
      [offsetDate(1, 3, 16, 40), 6, "en", "jp"],
      [offsetDate(1, 3, 19, 40), 6, "en", "jp"],
      [offsetDate(1, 3, 22, 40), 6, "en", "jp"],
      [offsetDate(1, 4, 10, 40), 6, "jp"],
      [offsetDate(1, 4, 13, 40), 6, "jp"],
      [offsetDate(1, 4, 16, 40), 6, "jp"],
      [offsetDate(1, 4, 19, 40), 6, "jp"],
      [offsetDate(1, 4, 22, 40), 6, "jp"],
      [offsetDate(1, 5, 10, 40), 6, "en", "jp"],
      [offsetDate(1, 5, 13, 40), 6, "en", "jp"],
      [offsetDate(1, 5, 16, 40), 6, "en", "jp"],
      [offsetDate(1, 5, 19, 40), 6, "en", "jp"],
      [offsetDate(1, 5, 22, 40), 6, "en", "jp"],
      [offsetDate(1, 6, 10, 40), 6, "jp"],
      [offsetDate(1, 6, 13, 40), 6, "jp"],
      [offsetDate(1, 6, 16, 40), 6, "jp"],
      [offsetDate(1, 6, 19, 40), 6, "jp"],
      [offsetDate(1, 6, 22, 40), 6, "jp"],

      [offsetDate(2, 0, 13, 40), 6, "en", "jp"],
      [offsetDate(2, 0, 16, 40), 6, "en", "jp"],
      [offsetDate(2, 0, 19, 40), 6, "en", "jp"],
      [offsetDate(2, 0, 22, 40), 6, "en", "jp"],
      [offsetDate(2, 1, 10, 40), 6, "jp"],
      [offsetDate(2, 1, 13, 40), 6, "jp"],
      [offsetDate(2, 1, 16, 40), 6, "jp"],
      [offsetDate(2, 1, 19, 40), 6, "jp"],
      [offsetDate(2, 1, 22, 40), 6, "jp"],
      [offsetDate(2, 2, 10, 40), 6, "en", "jp"],
      [offsetDate(2, 2, 13, 40), 6, "en", "jp"],
      [offsetDate(2, 2, 16, 40), 6, "en", "jp"],
      [offsetDate(2, 2, 19, 40), 6, "en", "jp"],
      [offsetDate(2, 2, 22, 40), 6, "en", "jp"],
      [offsetDate(2, 3, 10, 40), 6, "jp"],
      [offsetDate(2, 3, 13, 40), 6, "jp"],
      [offsetDate(2, 3, 16, 40), 6, "jp"],
      [offsetDate(2, 3, 19, 40), 6, "jp"],
      [offsetDate(2, 3, 22, 40), 6, "jp"],
      [offsetDate(2, 4, 10, 40), 6, "en", "jp"],
      [offsetDate(2, 4, 13, 40), 6, "en", "jp"],
      [offsetDate(2, 4, 16, 40), 6, "en", "jp"],
      [offsetDate(2, 4, 19, 40), 6, "en", "jp"],
      [offsetDate(2, 4, 22, 40), 6, "en", "jp"],
      [offsetDate(2, 5, 10, 40), 6, "jp"],
      [offsetDate(2, 5, 13, 40), 6, "jp"],
      [offsetDate(2, 5, 16, 40), 6, "jp"],
      [offsetDate(2, 5, 19, 40), 6, "jp"],
      [offsetDate(2, 5, 22, 40), 6, "jp"],
      [offsetDate(2, 6, 10, 40), 6, "en", "jp"],
      [offsetDate(2, 6, 13, 40), 6, "en", "jp"],
      [offsetDate(2, 6, 16, 40), 6, "en", "jp"],
      [offsetDate(2, 6, 19, 40), 6, "en", "jp"],
      [offsetDate(2, 6, 22, 40), 6, "en", "jp"],

      [offsetDate(3, 0, 13, 40), 6, "jp"],
      [offsetDate(3, 0, 16, 40), 6, "jp"],
      [offsetDate(3, 0, 19, 40), 6, "jp"],
      [offsetDate(3, 0, 22, 40), 6, "jp"],
      [offsetDate(3, 1, 10, 40), 6, "en", "jp"],
      [offsetDate(3, 1, 13, 40), 6, "en", "jp"],
      [offsetDate(3, 1, 16, 40), 6, "en", "jp"],
      [offsetDate(3, 1, 19, 40), 6, "en", "jp"],
      [offsetDate(3, 1, 22, 40), 6, "en", "jp"],
      [offsetDate(3, 2, 10, 40), 6, "jp"],
      [offsetDate(3, 2, 13, 40), 6, "jp"],
      [offsetDate(3, 2, 16, 40), 6, "jp"],
      [offsetDate(3, 2, 19, 40), 6, "jp"],
      [offsetDate(3, 2, 22, 40), 6, "jp"],
      [offsetDate(3, 3, 10, 40), 6, "en", "jp"],
      [offsetDate(3, 3, 13, 40), 6, "en", "jp"],
      [offsetDate(3, 3, 16, 40), 6, "en", "jp"],
      [offsetDate(3, 3, 19, 40), 6, "en", "jp"],
      [offsetDate(3, 3, 22, 40), 6, "en", "jp"],
      [offsetDate(3, 4, 10, 40), 6, "jp"],
      [offsetDate(3, 4, 13, 40), 6, "jp"],
      [offsetDate(3, 4, 16, 40), 6, "jp"],
      [offsetDate(3, 4, 19, 40), 6, "jp"],
      [offsetDate(3, 4, 22, 40), 6, "jp"],
      [offsetDate(3, 5, 10, 40), 6, "en", "jp"],
      [offsetDate(3, 5, 13, 40), 6, "en", "jp"],
      [offsetDate(3, 5, 16, 40), 6, "en", "jp"],
      [offsetDate(3, 5, 19, 40), 6, "en", "jp"],
      [offsetDate(3, 5, 22, 40), 6, "en", "jp"],
      [offsetDate(3, 6, 10, 40), 6, "jp"],
      [offsetDate(3, 6, 13, 40), 6, "jp"],
      [offsetDate(3, 6, 16, 40), 6, "jp"],
      [offsetDate(3, 6, 19, 40), 6, "jp"],
      [offsetDate(3, 6, 22, 40), 6, "jp"],
    ]);
  }
  set(sessions) {
    let now = new Date();
    let idBase = 0;
    while (
      sessions.length > 0 &&
      (this.getWeek(sessions[0][0]) < this.getWeek(now) ||
        sessions[0][0].getDate() < now.getDate() ||
        sessions[0][0].getHours() < now.getHours())
    ) {
      sessions.shift();
      idBase++;
    }

    sessions.forEach(([date, cinema, language, subs = null], id) => {
      this.addElem([
        "INPUT",
        {
          type: "radio",
          name: "sessions",
          value: id,
          id: "s" + id,
          onchange: (e) => this.select(id),
        },
      ]);
      this.addElem([
        "LABEL",
        { className: "session", id: id + idBase, htmlFor: "s" + id },
        [
          [
            "DIV",
            {
              innerText: date.toLocaleString(text[lang].dateFormat, {
                month: "short",
                day: "numeric",
              }),
            },
          ],
          [
            "DIV",
            {
              innerText: date.toLocaleString(text[lang].dateFormat, {
                weekday: "short",
              }),
            },
          ],
          ["DIV", { innerText: date.getHours() + ":" + date.getMinutes() }],
          ["IMG", { src: `images/movieTheatre/language/${language}Lang.png` }],
          [
            "DIV",
            {
              innerText:
                subs != null ? text[lang][subs] + text[lang].subs : null,
              className: "subs",
            },
          ],
        ],
      ]);
    });
  }
  get selectedDOM() {
    return this.DOM.children[this.selectedSession * 2 + 1];
  }
  get selectedDate() {
    return this.selectedSession == -1
      ? ""
      : this.selectedDOM.children[0].innerText;
  }
  get selectedTime() {
    return this.selectedSession == -1
      ? "0:00"
      : this.selectedDOM.children[2].innerText;
  }
  get selectedDOW() {
    return this.selectedSession == -1
      ? ""
      : this.selectedDOM.children[2].innerText;
  }
  get selectedLang() {
    if (this.selectedSession == -1) {
      return "enLang";
    }
    let src = this.selectedDOM.children[3].src.split("/");
    return src[src.length - 1].split(".")[0];
  }
  get selectedSubs() {
    return this.selectedSession == -1
      ? ""
      : this.selectedDOM.children[4].innerText;
  }
  getWeek(d) {
    d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
    d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));
    var yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
    var weekNo = Math.ceil(((d - yearStart) / 86400000 + 1) / 7);
    return weekNo;
  }
  select(id) {
    this.selectedSession = id;
    this.continuable = true;
  }
  setLang(parent) {
    this.actionText = text[lang].sessionSelector;
    this.DOM.innerText = "";
    this.fetchSessions();
    if (this.selectedSession != -1) {
      this.DOM.children[this.selectedSession * 2].checked = true;
    }
  }
}

class TicketSelector extends Screen {
  constructor(parent) {
    super(parent, "ticketSelector", text[lang].ticketSelector, {}, [
      ["SPAN", { innerText: text[lang].total + text[lang].colon }],
      { total: ["SPAN"] },
      ["BUTTON", { onclick: (e) => this.addTicket(), className: "addBtn" }],
      { tickets: ["DIV"] },
    ]);
    this.types = [
      ["adult", 15],
      ["senior", 10],
      ["student", 12],
      ["child", 8.5],
    ];
    this.addTicket();
  }
  get canContinue() {
    return this.tickets.children.length > 0;
  }
  addTicket() {
    this.addElem(
      [
        "DIV",
        {},
        [
          [
            "SELECT",
            { onchange: (e) => this.calculateTotal(), value: 0 },
            this.types.map((e, i) => [
              "OPTION",
              { innerText: text[lang][e[0]], value: i },
            ]),
          ],
          [
            "BUTTON",
            { onclick: (e) => this.removeTicket(e), className: "removeBtn" },
          ],
        ],
      ],
      this.tickets
    );
    this.calculateTotal();
    this.continuable = true;
  }

  calculateTotal() {
    let total = 0;
    [...this.tickets.children].forEach((e) => {
      total += this.types[e.children[0].value][1];
    });
    if (lang == 1) {
      total *= 100;
    }
    this.total.innerText = text[lang].currency + total;
  }
  removeTicket(e) {
    e = this.getE(e).parentNode;
    e.parentNode.removeChild(e);
    this.calculateTotal();
    if (this.tickets.children.length == 0) {
      this.continuable = false;
    }
  }
  setLang(parent) {
    this.actionText = text[lang].ticketSelector;
    this.calculateTotal();
    [...this.tickets.children].forEach((ticket) =>
      this.types.forEach(
        (e, i) => (ticket.children[0].children[i].innerText = text[lang][e[0]])
      )
    );
    this.DOM.children[0].innerText = text[lang].total + text[lang].colon;
  }
}

class SeatSelector extends Screen {
  constructor(parent, tickets, cols = 7, seats = 6) {
    super(
      parent,
      "seatSelector",
      text[lang].seatSelector,
      { tickets: tickets, seats: [] },
      [
        ...["lower", "upper"].map((e) => [
          "DIV",
          { className: "seats " + e },
          ["left", "center", "right"].map((section, id) => [
            "DIV",
            { className: "section " + section },
            [...Array(cols).keys()].map((col) => [
              "DIV",
              { className: "col" },
              [...Array(seats).keys()].map((seat) => [
                "DIV",
                { className: "seat", onclick: (s) => this.clickSeat(s) },
                [],
                (s) => s.style.setProperty("--seat", id * seats + seat),
              ]),
              (e) => e.style.setProperty("--col", col),
            ]),
          ]),
        ]),
      ]
    );
    this.cols = seats * 3;
    /*25 to 11
			let areaDiv=null,sectionDiv=null,colDiv=null,seatDiv=null;
			["lower","upper"].map(e=>{
				areaDiv=document.createElement("DIV");
				areaDiv.className="seats "+e;
				["left","center","right"].forEach((section,id)=>{
					id-=1;
					sectionDiv=document.createElement("DIV");
					sectionDiv.className="section "+section;
					for(let col=0;col<cols;col++){
						colDiv=document.createElement("DIV");
						colDiv.className="col";
						colDiv.style.setProperty('--col',col);
						sectionDiv.appendChild(colDiv);
						for(let seat=0;seat<seats;seat++){
							seatDiv=document.createElement("DIV");
							seatDiv.style.setProperty('--seat',seat);
							seatDiv.className="seat";
							seatDiv.onclick=e=>this.clickSeat(e);
							colDiv.appendChild(seatDiv);
						}
					}
					areaDiv.appendChild(sectionDiv);
				});
				this.DOM.appendChild(areaDiv)
			});*/
  }
  clickSeat(e) {
    e = this.getE(e);
    if (e.className == "col") {
      return;
    }
    if (!e.classList.contains("unselectable")) {
      let id =
        e.style.getPropertyValue("--seat") +
        "~" +
        e.parentNode.style.getPropertyValue("--col");
      if (this.seats.indexOf(id) != -1) {
        this.seats.splice(this.seats.indexOf(id), 1);
        e.classList.remove("active");
      } else if (!this.canContinue) {
        this.seats.push(id);
        e.classList.add("active");
      }
      this.continuable = this.canContinue;
    }
  }
  get canContinue() {
    return this.seats.length == this.tickets();
  }
  setLang(parent) {
    this.actionText = text[lang].seatSelector;
  }
}

class PreorderSnacks extends Screen {
  constructor(parent) {
    super(parent, "preorderSnacks", text[lang].preorderSnackScreen, {}, [
      { menuDOM: ["DIV"] },
      [
        "FIELDSET",
        {},
        [
          ["LEGEND", { innerText: text[lang].cart }],
          { cart: ["DIV"] },
          {
            total: [
              "DIV",
              {
                innerText: text[lang].currency + "0" + (lang == 0 ? ".00" : ""),
              },
            ],
          },
        ],
      ],
    ]);
    this.menu = [
      /*
				Popcorn 				Small													Salt
												Medium												Butter
												Large													Caramel
				
				Drink						Coke						L&P						Small
												Fanta						Root Beer			Medium
												Sprite					Orange Juice	Large
				
				Churro					Plain
												Chocolate
												Caramel
				
				Chocolate				Snickers				M&Ms
												Mars						Maltesers
												Milky Way				Mike & Ikes
				
				Ice Cream Cone	Plain
												Dip
												Nut Dip
				
				Kids Combo			Small Popcorn
												Small Drink
												Mini Dessert
				
				Combo						Medium Popcorn
												Medium Drink
												Dessert
				
				Super Combo			Medium Popcorn	Dessert
												Medium Drink
												Dessert
				
				Jumbo Combo			Large Popcorn
												Large Drink
												Dessert
				
				Epic Combo			Large Popcorn		Dessert
												Large Drink
												Dessert
				
				SE Combo				Medium Popcorn	Dessert
												Medium Drink		Special Gift
												Dessert
				*/
      [
        "popcorn",
        1.5,
        [
          [
            ["small", 0],
            ["medium", 1],
            ["large", 1.5],
          ],
          [
            ["salt", 0],
            ["butter", 0.2],
            ["caramel", 0.5],
          ],
        ],
      ],
      [
        "drink",
        1.8,
        [
          [
            ["small", 0],
            ["medium", 0.7],
            ["large", 1.7],
          ],
          [
            ["coke", 0],
            ["melonFanta", 0],
            ["sprite", 0],
            ["lp", 0],
            ["rootBeer", 0],
            ["orangeJuice", 0],
          ],
        ],
      ],
      [
        "churro",
        2,
        [
          [
            ["plain", 0],
            ["chocolate", 0.5],
            ["caramel", 0.5],
          ],
        ],
      ],
      [
        "chocolate",
        2,
        [
          [
            ["snickers", 0],
            ["mars", 0],
            ["milkyWay", 0],
            ["mMs", 0.5],
            ["maltesers", 0.5],
            ["mikeIkes", 0.5],
          ],
        ],
      ],
      [
        "iceCream",
        2,
        [
          [
            ["plain", 0],
            ["dip", 0.5],
            ["nutDip", 1],
          ],
        ],
      ],
      [
        "kidsCombo",
        2.5,
        [
          [
            [["small", "popcorn"], 0],
            [["small", "drink"], 0],
            ["miniDessert", 0],
          ],
        ],
      ],
      [
        "combo",
        (4.7 + 2) * 0.8,
        [
          [
            [["medium", "popcorn"], 0],
            [["medium", "drink"], 0],
            ["dessert", 0],
          ],
        ],
      ],
      [
        "superCombo",
        (4.7 + 4) * 0.8,
        [
          [
            [["medium", "popcorn"], 0],
            [["medium", "drink"], 0],
            ["dessert", 0],
            ["dessert", 0],
          ],
        ],
      ],
      [
        "jumboCombo",
        (3 + 3.5 + 2) * 0.8,
        [
          [
            [["large", "popcorn"], 0],
            [["large", "drink"], 0],
            ["dessert", 0],
          ],
        ],
      ],
      [
        "epicCombo",
        (3 + 3.5 + 6) * 0.8,
        [
          [
            [["large", "popcorn"], 0],
            [["large", "drink"], 0],
            ["dessert", 0],
            ["dessert", 0],
          ],
        ],
      ],
      [
        "specialEditionCombo",
        (4.7 + 2 + 3) * 0.8,
        [
          [
            [["medium", "popcorn"], 0],
            [["medium", "drink"], 0],
            ["dessert", 0],
            ["dessert", 0],
            ["specialGift", 0],
          ],
        ],
      ],
    ];
    this.comboStart = 5;
    this.initDOM();
  }
  initDOM() {
    this.menu.forEach((item, itemID) => {
      let s = lang == 0 ? " " : "",
        elems = [
          ["IMG", { src: `images/movieTheatre/snacks/${itemID}.jpg` }],
          ["DIV", { innerText: text[lang][item[0]] }],
          [
            "DIV",
            {},
            item[2].map((e, i) => {
              let elem = ["DIV", {}, []];
              e.forEach((e, id) => {
                let name = Array.isArray(e[0])
                  ? e[0].map((n) => text[lang][n]).join(s)
                  : text[lang][e[0]];
                elem[2].push([
                  "INPUT",
                  {
                    type: "radio",
                    name: "mOptions" + item[0] + i,
                    value: id,
                    id: "mOptions" + item[0] + i + id,
                    onchange: (e) =>
                      this.selectOption(this.getE(e), itemID, "snack"),
                  },
                ]);
                elem[2].push([
                  "LABEL",
                  {
                    className: "snackOption",
                    htmlFor: "mOptions" + item[0] + i + id,
                  },
                  [
                    ["DIV", { innerText: name }],
                    [
                      "DIV",
                      {
                        innerText:
                          e[1] != 0 ? "+" + this.formatMoney(e[1]) : "",
                      },
                    ],
                  ],
                ]);
              });
              return elem;
            }),
          ],
        ];
      if (elems.length < 4) {
        elems.push(["DIV"]);
      }
      elems.push(["DIV", { innerText: this.formatMoney(item[1]) }]);

      this.addElem(
        [
          "DIV",
          {
            className: "snack",
            id: itemID,
            onclick: (e) => this.menuItemSelected(this.getE(e)),
          },
          elems,
        ],
        this.menuDOM
      );
    });
  }
  //Set the total price of the selected item
  selectOption(e, item, source) {
    //source="cartItem":"snack"
    item = this.menu[item];
    while (e.className != source) {
      e = e.parentNode;
    }
    let price = this.price(
      ...[
        +e.id,
        ...item[2].map((field, i) => {
          i =
            source == "snack"
              ? document.querySelector(
                  `input[name="mOptions${item[0]}${i}"]:checked`
                )
              : e.children[1].children[i];
          return i == null ? 0 : +i.value;
        }),
      ]
    );
    e.children[e.children.length - 1].innerText = this.formatMoney(price);
  }
  price(...vars) {
    let id = vars[0];
    vars[0] = this.menu[id];
    let price = vars[0][1];
    if (id < this.comboStart) {
      for (let i = 1; i < vars.length; i++) {
        price += vars[0][2][i - 1][+vars[i]][1];
      }
    }
    return price;
  }
  menuItemSelected(e) {
    if (
      e.className != "snackOption" &&
      e.parentNode.className != "snackOption"
    ) {
      while (e.className != "snack") {
        e = e.parentNode;
      }
      let snack = this.menu[e.id];
      let options =
        e.id < this.comboStart
          ? snack[2].map((option, i) => {
              let value = document.querySelector(
                `input[name="mOptions${snack[0]}${i}"]:checked`
              );
              return [
                "SELECT",
                {
                  value: value == null ? 0 : value.value,
                  onchange: (elem) => {
                    this.selectOption(this.getE(elem), e.id, "cartItem");
                    this.calculateCartTotal();
                  },
                },
                option.map((e, id) => {
                  return ["OPTION", { innerText: text[lang][e[0]], value: id }];
                }),
              ];
            })
          : [];
      while (options.length < 2) {
        options.push(["SPAN"]);
      }
      let elem = this.addElem(
        [
          "div",
          { className: "cartItem", id: e.id },
          [
            ["DIV", { innerText: text[lang][snack[0]] }],
            ["DIV", {}, options],
            [
              "BUTTON",
              {
                onclick: (e) => this.deleteMenuItem(this.getE(e)),
                className: "removeBtn",
              },
            ],
            ["DIV"],
          ],
        ],
        this.cart
      );
      this.selectOption(elem, e.id, "cartItem");
      this.cart.scrollTo(0, this.cart.scrollHeight);
      this.calculateCartTotal();
    }
  }
  deleteMenuItem(e) {
    while (e.className != "cartItem") {
      e = e.parentNode;
    }
    e.parentNode.removeChild(e);
    this.calculateCartTotal();
  }
  calculateCartTotal() {
    let total = 0;
    for (let i = 0; i < this.cart.children.length; i++) {
      total += parseFloat(
        this.cart.children[i].children[3].innerText.substring(1)
      );
    }
    if (lang == 1) {
      total /= 100;
    }
    this.total.innerText = this.formatMoney(total);
  }
  get snacks() {
    let snacks = [];
    for (let i = 0; i < this.cart.children.length; i++) {
      let item = this.cart.children[i],
        menuItem = this.menu[item.id],
        snack = [];
      snack.push(text[lang][menuItem[0]]);
      if (item.id < this.comboStart) {
        snack.push(
          menuItem[2].map(
            (optSet, div) =>
              text[lang][optSet[item.children[1].children[div].value][0]]
          )
        );
      } else {
        snack.push([]);
      }
      snack.push(
        parseInt(item.children[item.children.length - 1].innerText.substring(1))
      );
      snacks.push(snack);
    }
    return snacks;
  }
  setLang(parent) {
    this.actionText = text[lang].preorderSnackScreen;
    let s = lang == 0 ? " " : "";
    [...this.DOM.children[0].children].forEach((e) => {
      let snack = this.menu[e.id];
      e.children[1].innerText = text[lang][snack[0]];
      snack[2].forEach((optSet, div) => {
        optSet.forEach((opt, i) => {
          let name = Array.isArray(opt[0])
            ? opt[0].map((n) => text[lang][n]).join(s)
            : text[lang][opt[0]];
          e.children[2].children[div].children[
            i * 2 + 1
          ].children[0].innerText = name;
          e.children[2].children[div].children[
            i * 2 + 1
          ].children[1].innerText =
            opt[1] != 0 ? "+" + this.formatMoney(opt[1]) : "";
        });
      });
      this.selectOption(e, e.id, "snack");
    });
    this.DOM.children[1].children[0].innerText = text[lang].cart;
    for (let i = 0; i < this.cart.children.length; i++) {
      let item = this.cart.children[i],
        snack = this.menu[item.id];
      item.children[0].innerText = text[lang][snack[0]];
      snack[2].forEach((optSet, div) => {
        optSet.forEach((opt, i) => {
          let name = Array.isArray(opt[0])
            ? opt[0].map((n) => text[lang][n]).join(s)
            : text[lang][opt[0]];
          item.children[1].children[div].children[i].innerText = name;
        });
      });
      this.selectOption(item, item.id, "cartItem");
    }
    this.calculateCartTotal();
  }
}

class ConfirmScreen extends Screen {
  constructor(parent) {
    super(parent, "confirmScreen", text[lang].confirmScreen, {}, [
      [
        "FIELDSET",
        {},
        [["LEGEND", { innerText: text[lang].movie }], { movieName: ["DIV"] }],
      ],
      [
        "FIELDSET",
        {},
        [
          ["LEGEND", { innerText: text[lang].when }],
          { date: ["DIV"] },
          { time: ["DIV"] },
        ],
      ],
      [
        "FIELDSET",
        {},
        [
          ["LEGEND", { innerText: text[lang].language }],
          { language: ["IMG"] },
          { subs: ["SPAN", { className: "subs" }] },
        ],
      ],
      [
        "FIELDSET",
        {},
        [
          ["LEGEND", { innerText: text[lang].seats }],
          { ticketsAndSeats: ["DIV"] },
        ],
      ],
      [
        "FIELDSET",
        {},
        [
          ["LEGEND", { innerText: text[lang].preorderedSnacks }],
          { snacks: ["DIV"] },
        ],
      ],
      [
        "FIELDSET",
        {},
        [["LEGEND", { innerText: text[lang].total }], { total: ["DIV"] }],
      ],
    ]);
  }
  onSelected(parent) {
    this.movieName.innerText = parent.movieName;
    this.date.innerText = parent.date;
    this.time.innerText =
      parent.time + text[lang].until + parent.endTime + text[lang].finished;
    this.language.src = `images/movieTheatre/language/${parent.language}.png`;
    this.language.innerText = parent.language;
    this.total.innerText = parent.total;
    this.subs.innerText = parent.subs;
    this.ticketsAndSeats.innerText = "";
    this.snacks.innerText = "";
    let seats = parent.seats;
    parent.tickets.forEach((ticket, i) =>
      this.addElem(
        ["DIV", { innerText: `${seats[i]}: ${ticket}` }],
        this.ticketsAndSeats
      )
    );
    let s = lang == 0 ? " " : "";
    parent.snacks.forEach((name) =>
      this.addElem(
        ["DIV", { innerText: [...name[1], name[0]].join(s) }],
        this.snacks
      )
    );
  }
  setLang(parent) {
    this.actionText = text[lang].confirmScreen;
    let labels = [
      "movie",
      "when",
      "language",
      "subtitles",
      "seats",
      "preorderedSnacks",
      "total",
    ];
    [...this.DOM.children].forEach(
      (e, i) => (e.children[0].innerText = text[lang][labels[i]])
    );
    this.onSelected(parent);
  }
}

class PaymentScreen extends Screen {
  constructor(parent) {
    super(parent, "paymentScreen", text[lang].paymentScreen, {}, [
      {
        tabOptions: [
          "DIV",
          {},
          [
            ["payAtCounter", text[lang].payAtCounter],
            ["creditcard", text[lang].creditCard],
            ["paypal", text[lang].payPal],
            ["linepay", text[lang].linePay],
            ["famimapay", text[lang].familyMartPay],
            ["711pay", text[lang].sevenElevenPay],
          ].map((e, i) => [
            "DIV",
            { onclick: (e) => this.select(i), title: e[1] },
            [["IMG", { src: `images/movieTheatre/payment/${e[0]}.png` }]],
          ]),
        ],
      },
      { window: ["DIV"] },
    ]);
    this.tabs = [
      this.addElem(["DIV", { innerText: text[lang].payAtCounterText }]),
      this.addElem(
        [
          "DIV",
          { className: "creditCard" },
          [
            [
              "DIV",
              { className: "payInput" },
              [
                ["LABEL", { forHTML: "name", innerText: text[lang].name }],
                [
                  "INPUT",
                  {
                    id: "name",
                    maxlength: 20,
                    type: "text",
                    oninput: (e) =>
                      this.onMaskInput(
                        this.getE(e),
                        0,
                        26,
                        /^(.[a-z]|[A-Z]|\s)*?/,
                        "",
                        false,
                        /[^a-zA-Z\s]/
                      ),
                  },
                ],
              ],
            ],
            [
              "DIV",
              { className: "payInput" },
              [
                [
                  "LABEL",
                  { forHTML: "cardnumber", innerText: text[lang].cardNumber },
                ],
                [
                  "INPUT",
                  {
                    id: "cardnumber",
                    maxlength: 20,
                    type: "text",
                    pattern: "[0-9]*",
                    inputmode: "numeric",
                    oninput: (e) => this.onCCNumInput(this.getE(e)),
                  },
                ],
                {
                  ccIMG: [
                    "IMG",
                    {
                      src: "images/movieTheatre/payment/blank.png",
                      className: "ccicon",
                    },
                  ],
                },
              ],
            ],
            [
              "DIV",
              { className: "payInput" },
              [
                [
                  "LABEL",
                  {
                    forHTML: "expirationdate",
                    innerText: text[lang].expiration,
                  },
                ],
                [
                  "INPUT",
                  {
                    id: "expirationdate",
                    maxlength: 20,
                    type: "text",
                    pattern: "[0-9]*",
                    inputmode: "numeric",
                    oninput: (e) =>
                      this.onMaskInput(
                        this.getE(e),
                        1,
                        4,
                        /^(0([1-9]?)|1([0-2]?))*(\/?)(([0-9]{1,2})?)$/,
                        "$1/$4",
                        true,
                        /^(0([1-9])|1([0-2]))(([0-9]{1,2}))$/
                      ),
                  },
                ],
              ],
            ],
            [
              "DIV",
              { className: "payInput" },
              [
                [
                  "LABEL",
                  { forHTML: "securitycode", innerText: text[lang].security },
                ],
                [
                  "INPUT",
                  {
                    id: "securitycode",
                    maxlength: 20,
                    type: "text",
                    pattern: "[0-9]*",
                    inputmode: "numeric",
                    oninput: (e) =>
                      this.onMaskInput(
                        this.getE(e),
                        3,
                        4,
                        /^([0-9]{0,4})$/,
                        "$1"
                      ),
                  },
                ],
              ],
            ],
          ],
        ],
        document.createElement("DIV")
      ).parentNode,
      ...["paypalLogin", "lineLogin"].map(
        (e) =>
          this.addElem(
            [
              "DIV",
              {},
              [
                ["DIV", { innerText: text[lang][e] }],
                [
                  "DIV",
                  {},
                  [
                    [
                      "LABEL",
                      { forHTML: "username", innerText: text[lang].username },
                    ],
                    ["INPUT", { id: "username", type: "text" }],
                  ],
                ],
                [
                  "DIV",
                  {},
                  [
                    [
                      "LABEL",
                      { forHTML: "password", innerText: text[lang].password },
                    ],
                    [
                      "INPUT",
                      { id: "password", type: "text", inputmode: "password" },
                    ],
                  ],
                ],
                ["IMG", { src: `images/movieTheatre/payment/${e}.png` }],
              ],
            ],
            document.createElement("DIV")
          ).parentNode
      ),
      ...["familyMartPayPage", "sevenElevenPayPage"].map(
        (e) =>
          this.addElem(
            ["DIV", { innerText: text[lang][e] }],
            document.createElement("DIV")
          ).parentNode
      ),
    ];

    this.mask = [];
    for (let i = 0; i < 4; i++) {
      this.mask[i] = "";
    }
    this.cardTypes = [
      ["amex", "0000 000000 00000", /^3[47]\d{0,13}/],
      ["visa", "0000 0000 0000 0000", /^4\d{0,15}/],
      [
        "discover",
        "0000 0000 0000 0000",
        /^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,
      ],
      [
        "maestro",
        "0000 0000 0000 0000",
        /^(?:5[0678]\d{0,2}|6304|67\d{0,2})\d{0,12}/,
      ],
      [
        "mastercard",
        "0000 0000 0000 0000",
        /^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,
      ],
      ["unionpay", "0000 0000 0000 0000", /^62\d{0,14}/],
    ];
    this.selected = 1;
    this.select(0);
  }
  select(tab) {
    if (
      tab != this.selected &&
      tab > -1 &&
      tab < this.tabOptions.children.length
    ) {
      this.tabOptions.children[this.selected].classList.remove("selected");
      this.tabOptions.children[tab].classList.add("selected");
      this.window.innerText = "";
      this.selected = tab;
      this.window.appendChild(this.tabs[tab]);
    }
  }
  onCCNumInput(e) {
    this.onMaskInput(e, 0, 16, /(.{0,4})/g, "$1 ");
    for (let i = 0; i < this.cardTypes.length; i++) {
      if (e.value.match(new RegExp(this.cardTypes[i][2]))) {
        if (i == 1) {
          this.ccIMG.src = `images/movieTheatre/payment/${this.cardTypes[i][0]}.png`;
        }
        return;
      }
    }
    this.ccIMG.src = `images/movieTheatre/payment/blank.png`;
  }
  onMaskInput(
    e,
    i,
    len = 16,
    check = /(.{0,4})/g,
    wit = "$1 ",
    numOnly = true,
    rep = check
  ) {
    if (e.value.match(new RegExp(check))) {
      if (numOnly) {
        this.mask[i] = e.value.replace(/\D/g, "").substring(0, len);
      } else {
        this.mask[i] = e.value.substring(0, len);
      }
    }
    e.value = this.mask[i].replace(rep, wit);
    if (numOnly) {
      e.value = e.value.trim();
    }
  }
  setLang(parent) {
    this.actionText = text[lang].paymentScreen;
    [
      "payAtCounter",
      "creditCard",
      "payPal",
      "linePay",
      "familyMartPay",
      "sevenElevenPay",
    ].forEach((e, i) => {
      this.DOM.children[0].children[i].title = text[lang][e];
    });
    this.tabs[0].innerText = text[lang].payAtCounterText;
    ["name", "cardNumber", "expiration", "security"].forEach((e, i) => {
      this.tabs[1].children[0].children[i].children[0].innerText =
        text[lang][e];
    });
    ["paypalLogin", "lineLogin"].forEach((e, i) => {
      console.log("?");
      this.tabs[i + 2].children[0].children[3].innerText = text[lang].submit;
      this.tabs[i + 2].children[0].children[0].innerText = text[lang][e];
      this.tabs[i + 2].children[0].children[1].children[0].innerText =
        text[lang].username;
      this.tabs[i + 2].children[0].children[2].children[0].innerText =
        text[lang].password;
    });
    ["familyMartPayPage", "sevenElevenPayPage"].forEach(
      (e, i) => (this.tabs[i + 4].children[0].innerText = text[lang][e])
      //	this.addElem(
      //		["DIV",{innerText:text[lang][e]}]
      //	,document.createElement("DIV")).parentNode
    );
  }
}

class TicketScreen extends Screen {
  constructor(parent) {
    super(parent, "ticketScreen", text[lang].ticketScreen, {}, [
      [
        "DIV",
        { className: "ticket" },
        [
          ["DIV", { innerText: text[lang].cinemaName }],
          { movieName: ["DIV"] },
          [
            "FIELDSET",
            {},
            [
              ["LEGEND", { innerText: text[lang].language }],
              { language: ["IMG"] },
              { subs: ["DIV"] },
            ],
          ],
          [
            "FIELDSET",
            {},
            [
              ["LEGEND", { innerText: text[lang].when }],
              { date: ["DIV"] },
              { time: ["DIV"] },
            ],
          ],
          [
            "FIELDSET",
            {},
            [["LEGEND", { innerText: text[lang].cinema }], { cinema: ["DIV"] }],
          ],
          [
            "FIELDSET",
            {},
            [
              ["LEGEND", { innerText: text[lang].seats }],
              { tickets: ["DIV"] },
              { seats: ["DIV"] },
            ],
          ],
          [
            "FIELDSET",
            {},
            [
              ["LEGEND", { innerText: text[lang].preorderedSnacks }],
              { snacks: ["DIV"] },
            ],
          ],
          [
            "FIELDSET",
            {},
            [["LEGEND", { innerText: text[lang].cost }], { price: ["DIV"] }],
          ],
          { barcode: ["CANVAS"] },
        ],
      ], //ticket
      [
        "DIV",
        {},
        [
          ["DIV", { innerText: text[lang].ticketWarning }],
          [
            "DIV",
            {},
            [
              [
                "LABEL",
                { forHTML: "name", innerText: text[lang].emailAddress },
              ],
              ["INPUT", { id: "name", maxlength: 20, type: "text" }],
              ["BUTTON", { innerText: text[lang].emailTicket }],
            ],
          ],
          ["BUTTON", { innerText: text[lang].printTicket, className: "shift" }],
        ],
      ], //print/email/save buttons
      ["DIV"], //payment section
    ]);
    this.idDict =
      "mrjoc0ksfew1tvqui2zphdl3ynxba4gMRJO5CKSFE6WTVQU7IZPHD8LYNXB9AG";
    this.barcode = new QRious({
      element: this.barcode,
      value: "randomCinema:" + this.encodeID(parent.id),
      size: 260,
    });
  }
  onSelected(parent) {
    super.onSelected();
    this.movieName.innerText = parent.movieName;
    //Set ticket
    this.date.innerText = parent.date;
    this.time.innerText =
      parent.time + text[lang].until + parent.endTime + text[lang].finished;
    this.language.src = `images/movieTheatre/language/${parent.language}.png`;
    this.subs.innerText = parent.subs;
    this.cinema.innerText = "6";
    this.tickets.innerText = "";
    this.seats.innerText = "";
    this.snacks.innerText = "";
    this.price.innerText = `${text[lang].currency}${
      36 * (lang == 0 ? 1 : 100)
    }`;
    parent.tickets.forEach((ticket, i) => {
      this.addElem(["DIV", { innerText: parent.seats[i] }], this.seats);
      this.addElem(["DIV", { innerText: ticket }], this.tickets);
    });
    let s = lang == 0 ? " " : "";
    parent.snacks.forEach((name) =>
      this.addElem(
        ["SPAN", { innerText: [...name[1], name[0]].join(s) }],
        this.snacks
      )
    );

    let payment = parent.payment;
    this.DOM.children[2].innerText = "";
    switch (payment) {
      case 0:
        this.DOM.children[2].innerText = text[lang].payAtCounterText;
        break;
      case 1:
      case 2:
      case 3:
        this.DOM.children[2].innerText = text[lang].successfullyPaid;
        break;
      case 4:
        this.addElem([
          "DIV",
          {},
          [
            ["DIV", { innerText: text[lang].payAtFamiMa }],
            ["DIV", { innerText: text[lang].paymentInstruction }],
            [
              "BUTTON",
              {
                innerText: text[lang].paymentGuide,
                className: "paymentGuide",
                onclick: (e) =>
                  window
                    .open(
                      text[lang].googleTranslate +
                        "https://www.family.co.jp/services/ticket/ticketreserve.html",
                      "_blank"
                    )
                    .focus(),
              },
            ],
          ],
        ]);
        break;
      case 5:
        this.addElem([
          "DIV",
          {},
          [
            ["DIV", { innerText: text[lang].payAtSevenEleven }],
            ["DIV", { innerText: text[lang].paymentInstruction }],
            [
              "BUTTON",
              {
                innerText: text[lang].paymentGuide,
                className: "paymentGuide",
                onclick: (e) =>
                  window
                    .open(
                      text[lang].googleTranslate + "7ticket.jp/guide",
                      "_blank"
                    )
                    .focus(),
              },
            ],
          ],
        ]);
        break;
    }
  }
  get canContinue() {
    return false;
  }
  print() {}
  setLang(parent) {
    this.actionText = text[lang].ticketScreen;
    this.DOM.children[0].children[0].innerText = text[lang].cinemaName;
    ["language", "when", "cinema", "seats", "preorderedSnacks", "cost"].forEach(
      (e, i) => {
        this.DOM.children[0].children[i + 2].children[0].innerText =
          text[lang][e];
      }
    );
    this.DOM.children[1].children[0].innerText = text[lang].ticketWarning;
    this.DOM.children[1].children[1].children[0].innerText =
      text[lang].emailAddress;
    this.DOM.children[1].children[1].children[2].innerText =
      text[lang].emailTicket;
    this.DOM.children[1].children[2].innerText = text[lang].printTicket;
    this.onSelected(parent);
  }
  encodeID(value) {
    if (value == null || typeof value != "number") {
      throw new Error("ID needs to be a number");
    }
    value = parseInt(value + 100000000000);

    var result = "",
      length = this.idDict.length;
    for (
      let index = Math.floor(Math.log(value) / Math.log(length));
      index >= 0;
      index--
    ) {
      result += this.idDict.substr(
        Math.floor(value / Math.pow(length, index)) % length,
        1
      );
    }

    return result.split("").reverse().join("");
  }
  decodeID(encoded) {
    if (encoded == null || typeof encoded != "string") {
      throw new Error("Encoded ID needs to be a string.");
    }

    var encoded = encoded.split("").reverse().join("");
    var result = 0;

    for (let index = 0; index <= encoded.length - 1; index++) {
      result =
        result +
        this.idDict.indexOf(encoded.substr(index, 1)) *
          Math.pow(this.idDict.length, encoded.length - 1 - index);
    }
    return result - 100000000000;
  }
}
</script>
<style>
html, body {
	width: 95vw;
	height: 100vh;
}
:root {
	--background: white;
	--confirm: green;
	--confirmHover: darkgreen;
	--reject: red;
	--rejectHover: darkred;
	--disabled: darkgrey;
	--selectHover: darkgrey;
	--selected: grey;
	--sessionText: white;
	--sessionBG: darkgrey;
	--sessionBGHover: grey;
	--sessionSelected: green;
	--sessionBorder: black;
	--ticketBG: lightgray;
	--ticketSelectBG: white;
	--confirmText: white;
	--rejectText: white;
	--snackOptionText: white;
	--snackOptionBorder: black;
	--snackOptionBG: darkgrey;
	--snackOptionBGHover: grey;
	--border: black;
	--creditCardText: #707070;
	--tabHover: lightgrey;
	--borderHover: grey;
	--cinemaText: white;
	--cinemaBG: black;
	--ticketTypeText: white;
	--ticketTypeBG: black;
	--seatTypeText: black;
	--seatTypeBG: lightgrey;
	--snackText: white;
	--snackBG: black;
	--snackTextAlt: lightgrey;
	--snackBGAlt: black;
}
button {
	cursor: pointer;
	display: inline-block;
	background-color: var(--confirm);
	color: var(--confirmText);
	border-radius: 15px;
	border: 0;
	padding: 10px;
	font-weight: bold;
	z-index: 98;
	cursor: pointer;
}
button:hover:enabled {
	background-color: var(--confirmHover);
	-moz-box-shadow: inset 0 0 5px #000000;
	-webkit-box-shadow: inset 0 0 5px #000000;
	box-shadow: inset 0 0 5px #000000;
}
button[disabled] {
	cursor: default;
	color: var(--confirmHover);
}
.movieTheatre {
	margin-left: auto;
	margin-right: auto;
	padding: 0;
	height: 100%;
	width: 100%;
	font-family: Arial;
	text-align: center;
}
.movieTheatre>div:nth-of-type(3) {
	position: fixed;
	top: 2%;
	left: 4%;
	z-index: 100;
	font-weight: bold;
	text-align: center;
	font-size: 1.5em;
	border: solid;
	border-radius: 15px;
	padding: 5px;
	display: inline-block;
	background-color: lightgrey;
}
.screen {
	width: 100%;
	position: relative;
	text-align: center;
}
.screen>div {
	margin-top: 4em;
	overflow: scroll;
}
.navBtn {
	position: fixed;
	bottom: 5%;
	left: 20%;
	padding: 8px;
	background-color: var(--reject);
	border-radius: 12px;
	text-decoration: none;
	border: none;
	font-weight: bold;
}
button[disabled]:nth-of-type(1) {
	color: var(--rejectHover);
}
.navBtn:nth-of-type(1):hover:enabled {
	background-color: var(--rejectHover);
}
.navBtn:nth-of-type(2) {
	background-color: var(--confirm);
	left: auto;
	right: 20%;
}
.navBtn:nth-of-type(2).button:hover:enabled {
	background-color: var(--confirmHover);
	-moz-box-shadow: inset 0 0 5px #000000;
	-webkit-box-shadow: inset 0 0 5px #000000;
	box-shadow: inset 0 0 5px #000000;
}
.movieTheatre>.language {
	position: fixed;
	z-index: 100;
	right: 3px;
	top: 3px;
	height: 20px;
}
.movieTheatre>.language>img {
	height: 100%;
}
.movieTheatre>.language>img.selected {
	border: solid;
}
/*Curtains*/

.curtains {
	width: 100vw;
	height: 100vh;
	left: 0;
	top: 0;
	position: absolute;
	z-index: 150;
	pointer-events: none
}
.curtains>div {
	width: 50vw;
	height: 100vh;
	position: fixed;
	transform-origin: left;
	transition: all 0.3s ease-out;
	background-size: 100% 100%;
	background-repeat: no-repeat;
	background-image: url("images/movieTheatre/leftCurtain.png");
}
.curtains.open>div {
	transform: scaleX(0);
}
.curtains>div:nth-child(even) {
	left: 50vw;
	transform-origin: right;
	background-image: url("images/movieTheatre/rightCurtain.png");
}
/*Movie Selector*/

.movie {
	gap: 0px;
	display: grid;
	padding-bottom: 3px;
	border-radius: 12px;
	grid-template-rows: 1fr 1fr 1fr 1fr;
	grid-template-columns: 1fr 1fr 1fr 1fr;
}
.movie:hover {
	cursor: pointer;
	background-color: var(--selectHover);
}
.movie img:nth-child(1) {
	width: 200px;
	height: 300px;
	margin: auto;
	grid-column: 1/1;
	grid-row: 1/5;
}
.movie div:nth-child(2) {
	margin: auto;
	font-size: 200%;
	font-weight: bold;
	grid-column: 2/5;
	grid-row: 1/2;
}
.movie div:nth-child(3) {
	margin-left: 10px;
	overflow-y: hidden;
	grid-column: 2/5;
	grid-row: 2/4;
}
.movie div:nth-child(4) {
	margin: auto;
	grid-column: 2/3;
	grid-row: 4/4;
}
.movie div:nth-child(5) {
	margin: auto;
	grid-column: 4/5;
	grid-row: 4/4;
}
.movieSelector input[type=radio] {
	display: none
}
input[type=radio]:checked+.movie {
	background-color: var(--selected);
	border: 3px solid black;
}
/*Session Selector*/

.sessionSelector {
	gap: 2px;
	display: flex;
	flex-wrap: wrap;
	justify-content: space-evenly;
}
.session {
	color: var(--sessionText);
	border-radius: 0;
	border: 1 solid var(--sessionBorder);
	background-color: var(--sessionBG);
	width: 120px;
	gap: 0px;
	display: grid;
	grid-template-rows: 1fr 1fr 1fr;
	grid-template-columns: 0.7fr 1fr;
}
.session:hover {
	cursor: pointer;
	background-color: var(--sessionBGHover);
}
.session img {
	margin: auto;
	height: 20px;
	grid-column: 1/2;
	grid-row: 3/4;
}
.session div:nth-of-type(1) {
	margin: auto;
	font-weight: bold;
	grid-column: 1/3;
	grid-row: 1/2;
}
.session div:nth-of-type(2) {
	margin: auto;
	font-weight: bold;
	grid-column: 1/2;
	grid-row: 2/3;
}
.session div:nth-of-type(3) {
	margin: auto;
	grid-column: 2/3;
	grid-row: 2/3;
}
.session div:nth-of-type(4) {
	margin: auto;
	grid-column: 2/3;
	grid-row: 3/4;
}
.subs {
	font-size: smaller;
	vertical-align: sub;
}
.sessionSelector input[type=radio] {
	display: none
}
input[type=radio]:checked+.session {
	background-color: var(--sessionSelected);
	border: 3px solid var(--sessionBorder);
}
/*Ticket Selector*/

.ticketSelector {
	margin-left: auto;
	margin-right: auto;
	padding: 15px;
	max-width: 400px;
	border-radius: 15px;
	background-color: var(--ticketBG);
}
.ticketSelector select {
	width: 88%;
	padding: 10px;
	margin-top: 3px;
	margin-right: 2%;
	font-size: 16px;
	font-weight: bold;
	text-align: center;
	border-radius: 15px;
	background-color: var(--ticketSelectBG);
	border: 1px solid #dcdcdc;
	appearance: none;
	-moz-appearance: none;
	-webkit-appearance: none;
	background-position-x: 97%;
	background-position-y: 6px;
	background-repeat: no-repeat;
	background-image: url("data:image/svg+xml;utf8,<svg fill='black' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/><path d='M0 0h24v24H0z' fill='none'/></svg>");
}
.ticketSelector select:focus {
	outline: none;
}
.ticketSelector span:nth-of-type(1) {
	float: left;
}
.ticketSelector span {
	font-size: 30px;
}
.ticketSelector button:nth-of-type(1) {
	float: right;
}
.addBtn {
	border: 0;
	width: 35px;
	height: 35px;
	color: var(--confirmText);
	font-size: 25px;
	font-weight: bold;
	padding: 0;
	border-radius: 100%;
	background-color: var(--confirm);
}
.removeBtn {
	border: 0;
	width: 40px;
	height: 40px;
	font-size: 20px;
	padding: 0;
	font-weight: bold;
	border-radius: 100%;
	color: var(--rejectText);
	background-color: var(--reject);
}
.addBtn:after {
	content: "+";
}
.removeBtn:after {
	content: "×";
}
.addBtn:hover {
	background-color: var(--confirmHover);
}
.removeBtn:hover {
	background-color: var(--rejectHover);
}
/*Seat Selector*/

.seatSelector {
	text-align: center;
}
.seats {
	width: 100vw;
	height: 10vw;
	margin: 5% 5%;
	display: flex;
}
.section {
	width: 23.4%;
	display: flex;
}
.col {
	width: 14%;
	height: 100%;
	margin: 0 3%;
}
.seat {
	width: 100%;
	height: 3vw;
	margin-bottom: -60%;
	border-radius: 10px;
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
	background: linear-gradient(to top, #006400, #006400, #006400, #006400, #006400, #228B22, #32CD32);
}
.seat:hover {
	content: "";
	border-radius: 10px;
	background: linear-gradient(to top, #004400, #004400, #004400, #004400, #004400, #117611, #21BC21);
}
.seat.active {
	border-radius: 10px;
	background: linear-gradient(to top, #000044, #000044, #000044, #000044, #000044, #111176, #2121BC);
}
.seat.unselectable {
	border-radius: 10px;
	background: rgba(0, 0, 0, 1);
}
.seat:not(.unselectable) {
	cursor: pointer;
}
.section:not(.center).seat:hover:before, .section:not(.center).seat.active:before, .section:not(.center).seat.unselectable:before {
	top: 0;
	width: 100%;
	height: 100%;
	position: absolute;
}
.left .col {
	transform: skew(calc((var(--col) - 14)*1deg));
}
.left .seat {
	transform: skew(calc((20 - var(--col)*2)*1deg));
}
.center {
	margin-left: 2vw;
}
.right {
	margin-left: 2vw;
}
.right .col {
	transform: skew(calc((var(--col) + 8)*1deg));
}
.right .seat {
	transform: skew(calc((var(--col)*-2 - 8)*1deg));
}
/*Preorder Snacks*/

.preorderSnacks {
	display: flex;
	position: relative;
}
.preorderSnacks>div {
	width: 66%;
}
.preorderSnacks>fieldset {
	width: 33%;
	border: 2px solid black;
	display: flex;
	flex-flow: column;
	position: fixed;
	height: 80vh;
	right: 1%;
	top: 6%;
	padding: 0;
	background-color: var(--background);
}
.preorderSnacks>fieldset>div:nth-child(3) {
	flex: 0 1 auto;
	font-weight: bold;
	font-size: 1.5em;
	text-align: right;
	padding-right: 4px;
}
.preorderSnacks>fieldset>div:nth-child(2) {
	overflow: scroll;
	flex: 1 1 auto;
}
.snack {
	gap: 0px;
	display: grid;
	padding-bottom: 3px;
	border-radius: 12px;
	grid-template-rows: 1fr 1fr 1fr;
	grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr;
}
.snack:hover {
	cursor: pointer;
	background-color: grey;
}
.snack img {
	margin: 5px;
	width: 80px;
	height: 80px;
	grid-column: 1/2;
	grid-row: 1/3;
}
.snack>div:nth-child(2) {
	margin: auto;
	white-space: nowrap;
	font-weight: bold;
	grid-column: 1/2;
	grid-row: 3/4;
}
.snack>div:nth-child(3) {
	margin: 5px;
	grid-column: 2/6;
	grid-row: 1/4;
	gap: 8px;
	display: flex;
	flex-wrap: wrap;
	flex-direction: row;
	align-content: space-between;
	justify-content: space-evenly;
}
.snack>div:nth-child(3)>div {
	display: flex;
	flex-wrap: wrap;
	flex-direction: column;
	align-content: space-between;
	gap: 1px;
}
.snack>div:nth-child(4) {
	margin: auto;
	font-weight: bold;
	grid-column: 6/7;
	grid-row: 1/4;
}
.snackOption {
	width: 130px;
	border-radius: 0;
	color: var(--snackOptionText);
	background-color: var(--snackOptionBG);
	border: 1 solid var(--snackOptionBorder);
}
.snackOption:hover {
	background-color: var(--snackOptionBGHover);
}
.snackOption div:nth-child(1) {
	float: left;
}
.snackOption div:nth-child(2) {
	float: right;
	background-color: var(--confirm);
	width: 50px;
}
.cartItem>.removeBtn {
	transform: scale(-75%);
}
.cartItem {
	gap: 0px;
	display: grid;
	padding-bottom: 3px;
	border-radius: 12px;
	grid-template-rows: 1fr 1fr;
	grid-template-columns: 1fr 1fr 1fr 1fr;
}
.cartItem div:nth-child(1) {
	margin: auto;
	font-weight: bold;
	grid-column: 1/3;
	grid-row: 1/2;
}
.cartItem div:nth-child(2) {
	display: flex;
	flex-wrap: wrap;
	grid-column: 1/5;
	grid-row: 2/3;
}
.cartItem button:nth-child(3) {
	margin: auto;
	grid-column: 4/5;
	grid-row: 1/2;
}
.cartItem div:nth-child(4) {
	margin: auto;
	grid-column: 3/4;
	grid-row: 1/2;
}
.cartItem select {
	text-align: center;
	margin: 5px;
	width: 130px;
}
.snack input[type=radio] {
	display: none
}
input[type=radio]:checked+.snackOption {
	background-color: var(--confirm);
	border: 3px solid var(--border);
}
/*Confirm Screen*/

.confirmScreen img {
	height: 20px;
}
/*Payment*/

.creditCard .payInput:nth-of-type(1) {
	grid-area: name;
}
.creditCard .payInput:nth-of-type(2) {
	grid-area: number;
}
.creditCard .payInput:nth-of-type(3) {
	grid-area: expiration;
}
.creditCard .payInput:nth-of-type(4) {
	grid-area: security;
}
.payInput input {}
.payInput {
	position: relative;
}
.creditCard {
	display: grid;
	grid-column-gap: 10px;
	grid-template-columns: auto auto;
	grid-template-rows: 90px 90px 90px;
	grid-template-areas: "name name""number number""expiration security";
	max-width: 400px;
	padding: 20px;
	color: var(--creditCardText);
}
.paymentScreen label {
	padding-bottom: 5px;
	font-size: 13px;
}
.paymentScreen input {
	-webkit-box-sizing: border-box;
	box-sizing: border-box;
	margin-top: 3px;
	padding: 15px;
	font-size: 16px;
	width: 100%;
	border-radius: 3px;
	border: 1px solid #dcdcdc;
}
.payInput img {
	height: 38px;
	position: absolute;
	right: 6px;
	top: calc(50% - 17px);
	width: 60px;
}
.paymentScreen>div:nth-of-type(1) {
	display: flex;
	justify-content: stretch;
	flex-flow: row nowrap;
}
.paymentScreen>div:nth-of-type(1)>div {
	flex-basis: 100%;
	border-style: none none solid none;
	text-align: center;
}
.paymentScreen>div:nth-of-type(1)>div:not(.selected):hover {
	background-color: var(--tabHover);
	border-width: 0.2px;
	border-color: var(--borderHover);
	border-style: solid;
	border-bottom-width: 3px;
	border-bottom-color: var(--border);
	border-radius: 10px 10px 0 0;
}
.paymentScreen {
	overflow: hidden;
}
.paymentScreen>div:nth-of-type(1)>div.selected {
	border-style: solid solid none solid;
	border-radius: 10px 10px 0 0;
}
.paymentScreen>div:nth-of-type(2) {
	padding: 10px;
	text-align: center;
	overflow: scroll;
	height: 83.5%;
	border-style: none solid solid solid;
}
.paymentScreen>div:nth-of-type(2)>div {
	display: inline-block
}
/*ticketScreen*/

.ticket {
	border-weight: 0.5px;
	border: dotted;
	gap: 0px;
	display: grid;
	border-radius: 12px;
	align-content: stretch;
	justify-content: center;
	height: 300px;
	width: 950px;
	grid-template-rows: 0.2fr 0.2fr 1fr 1fr;
	grid-template-columns: 0.3fr 1fr 1fr 1fr 1fr 1fr;
	text-align: center;
	margin: auto;
}
.ticket>div:nth-of-type(1) {
	writing-mode: vertical-rl;
	margin: auto;
	width: 100%;
	height: 100%;
	color: var(--cinemaText);
	background-color: var(--cinemaBG);
	margin: auto;
	text-orientation: sideways;
	transform: rotate(180deg);
	font-size: 200%;
	font-weight: bold;
	grid-column: 1/2;
	grid-row: 1/5;
}
.ticket>div:nth-of-type(2) {
	font-size: 200%;
	margin: auto;
	font-weight: bold;
	grid-column: 2/5;
	grid-row: 1/2;
}
.ticket>fieldset:nth-of-type(1) {
	display: flex;
	flex-flow: row nowrap;
	justify-content: space-evenly;
	grid-column: 5/6;
	grid-row: 1/2;
}
.ticket>fieldset:nth-of-type(1) img {
	height: 20px;
}
.ticket>fieldset:nth-of-type(2) {
	grid-column: 2/4;
	grid-row: 2/3;
}
.ticket>fieldset:nth-of-type(3) {
	grid-column: 4/5;
	grid-row: 2/3;
}
.ticket>fieldset:nth-of-type(3)>div {
	width: 100%;
	height: 100%;
	font-size: 2.8vw;
}
.ticket>fieldset:nth-of-type(4) {
	display: grid;
	gap: 3px;
	grid-template-columns: 1fr 1fr;
	grid-column: 5/6;
	grid-row: 2/4;
}
.ticket>fieldset:nth-of-type(4)>div>div {
	margin-bottom: 3px;
	background-color: var(--ticketTypeBG);
	border-radius: 10px;
	color: var(--ticketTypeText);
}
.ticket>fieldset:nth-of-type(4)>div:nth-of-type(2)>div {
	background-color: var(--seatTypeBG);
	color: var(--seatTypeText);
}
.ticket>fieldset:nth-of-type(5) {
	grid-column: 2/5;
	grid-row: 3/5;
	margin: 0;
}
.ticket>fieldset:nth-of-type(5) div {
	display: flex;
	flex-direction: column;
	text-align: left;
	height: 100%;
	flex-wrap: wrap;
}
.ticket>fieldset:nth-of-type(5)>div>span {
	text-align: center;
	width: 20%;
	margin-bottom: 2px;
	background-color: var(--snackBG);
	border-radius: 10px;
	color: var(--snackText);
}
.ticket>fieldset:nth-of-type(5)>div>span:nth-of-type(odd) {
	background-color: var(--snackBGAlt);
	color: var(--snackTextAlt);
}
.ticket>fieldset:nth-of-type(6) {
	grid-column: 5/6;
	grid-row: 4/5;
}
.ticket>fieldset:nth-of-type(6)>div {
	width: 100%;
	height: 100%;
	font-size: 3vw;
}
.ticket>canvas:nth-of-type(1) {
	padding: 20px;
	grid-column: 6/7;
	grid-row: 1/5;
}
.ticketScreen button {
	font-size: 20px;
	width: 180px;
	margin: 5px;
}
.ticketScreen label {
	display: block;
	font-size: smaller;
	color: darkgrey;
}
.ticketScreen input {
	width: 280px;
	padding: 10px;
}
.ticketScreen>div:nth-of-type(2)>div:nth-of-type(1) {
	color: red;
	background-color: black;
	padding: 5px;
	margin-top: 5px;
	margin-bottom: 5px;
	font-weight: bold;
}
.ticketScreen>div:nth-of-type(2)>div:nth-of-type(1) {
	color: red;
	background-color: black;
	padding: 5px;
	font-weight: bold;
}
.ticketScreen>div:nth-of-type(2)>button:nth-of-type(1) {
	background-color: blue;
}
.ticketScreen>div:nth-of-type(2)>button:nth-of-type(1):hover {
	background-color: darkblue;
}
.ticketScreen>div:nth-child(4) {
	margin: 5px;
	font-size: 20px;
}
</style>